<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Architecture Strategies - Software Architecture Guide</title>
<link rel="icon" type="image/png" href="images/favicon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 30px 40px;
            border-bottom: 4px solid #2563eb;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header .course-title {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }
        
        header h1 {
            font-size: 2em;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .content {
            padding: 40px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .content h2 {
            color: #1e40af;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3b82f6;
        }
        
        .content h3 {
            color: #1e3a8a;
            margin-top: 25px;
            margin-bottom: 12px;
        }
        
        .content h4 {
            color: #3730a3;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .content p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .content pre {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            overflow-x: auto;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .content code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .content table th,
        .content table td {
            padding: 12px;
            border: 1px solid #e2e8f0;
            text-align: left;
        }
        
        .content table th {
            background-color: #3b82f6;
            color: white;
            font-weight: 600;
        }
        
        .content table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .content ul, .content ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        .content li {
            margin-bottom: 8px;
        }
        
        .content blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 20px;
            margin: 20px 0;
            color: #475569;
            font-style: italic;
        }
        
        .chapter-nav {
            border-top: 2px solid #e2e8f0;
            padding: 30px 40px;
            background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }
        
        .nav-button {
            display: inline-block;
            padding: 14px 28px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
            flex: 1;
            text-align: center;
            font-size: 0.9em;
            max-width: 300px;
        }
        
        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .nav-button.prev::before {
            content: "â† ";
        }
        
        .nav-button.next::after {
            content: " â†’";
        }
        
        .nav-button.disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            box-shadow: none;
            pointer-events: none;
        }
        
        .home-button {
            padding: 12px 24px;
            background-color: #475569;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .home-button:hover {
            background-color: #334155;
            transform: translateY(-2px);
        }
        
        .home-button::before {
            content: "ğŸ—ï¸ ";
        }
        
        @media (max-width: 768px) {
            .chapter-nav {
                flex-direction: column;
            }
            
            .nav-button {
                max-width: 100%;
            }
            
            header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="course-title">Software Architecture Design Guide</div>
            <h1>Database Architecture Strategies</h1>
        </header>
        
        <main class="content">
            <div class="px-2"><h1 id="Section-9"><a href="index.html">Section 9: Database Architecture Strategies</a></h1>
<hr>
<h2>ğŸ“‹ SECTION SUMMARY</h2>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    DATABASE ARCHITECTURE STRATEGIES                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  WHAT IT COVERS:                                                            â”‚
â”‚  â€¢ Choosing the right database type for your use case                       â”‚
â”‚  â€¢ Data modeling strategies for different paradigms                         â”‚
â”‚  â€¢ Scaling databases horizontally and vertically                            â”‚
â”‚  â€¢ Ensuring data consistency, availability, and partition tolerance         â”‚
â”‚  â€¢ Performance optimization through indexing and query design               â”‚
â”‚                                                                             â”‚
â”‚  WHY IT MATTERS:                                                            â”‚
â”‚  â€¢ Database is often the primary bottleneck in applications                 â”‚
â”‚  â€¢ Wrong database choice can cripple system performance                     â”‚
â”‚  â€¢ Data architecture impacts every layer of the application                 â”‚
â”‚  â€¢ Migration costs are extremely high once data accumulates                 â”‚
â”‚                                                                             â”‚
â”‚  KEY OPTIMIZATION TIPS:                                                     â”‚
â”‚  âœ“ Choose database type based on data access patterns, not hype            â”‚
â”‚  âœ“ Design schema for queries, not just data storage                        â”‚
â”‚  âœ“ Index strategically - too many indexes hurt write performance           â”‚
â”‚  âœ“ Use connection pooling to manage database connections                   â”‚
â”‚  âœ“ Implement read replicas to scale read-heavy workloads                   â”‚
â”‚  âœ“ Consider polyglot persistence for complex systems                       â”‚
â”‚  âœ“ Plan for data growth from day one                                       â”‚
â”‚  âœ“ Separate operational and analytical workloads                           â”‚
â”‚                                                                             â”‚
â”‚  CORE CONCEPTS:                                                             â”‚
â”‚  â€¢ CAP Theorem and trade-offs                                               â”‚
â”‚  â€¢ ACID vs BASE consistency models                                          â”‚
â”‚  â€¢ Normalization vs Denormalization                                         â”‚
â”‚  â€¢ Sharding and Partitioning strategies                                     â”‚
â”‚  â€¢ Replication patterns                                                     â”‚
â”‚  â€¢ CQRS and Event Sourcing                                                  â”‚
â”‚                                                                             â”‚
â”‚  DATABASE CATEGORIES COVERED:                                               â”‚
â”‚  â€¢ Relational (RDBMS)      â€¢ Document stores                                â”‚
â”‚  â€¢ Key-Value stores        â€¢ Column-family stores                           â”‚
â”‚  â€¢ Graph databases         â€¢ Time-series databases                          â”‚
â”‚  â€¢ Search engines          â€¢ NewSQL databases                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.1 Introduction to Database Architecture</h2>
<h3>The Critical Role of Data Architecture</h3>
<p>Database architecture forms the <strong>foundation of any data-driven application</strong>. It determines how data is stored, accessed, modified, and protected. Poor database architecture decisions are among the most expensive mistakes in software development because:</p>
<ol>
<li><strong>Data is persistent</strong> - Unlike code, you can't simply "rewrite" accumulated data</li>
<li><strong>Migration is risky</strong> - Moving data between systems risks loss and corruption</li>
<li><strong>Performance is critical</strong> - Database bottlenecks affect entire application performance</li>
<li><strong>Consistency matters</strong> - Data integrity issues can have serious business consequences</li>
</ol>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    DATABASE ARCHITECTURE DECISIONS IMPACT                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Application Layer                                                         â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â–¼                                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚                    DATABASE ARCHITECTURE                         â”‚       â”‚
â”‚   â”‚                                                                  â”‚       â”‚
â”‚   â”‚   Impacts:                                                       â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Query Performance (response time)                          â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Write Throughput (transactions/second)                     â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Data Consistency (correctness guarantees)                  â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Availability (uptime during failures)                      â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Scalability (handling growth)                              â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Operational Complexity (maintenance burden)                â”‚       â”‚
â”‚   â”‚   â”œâ”€â”€ Cost (infrastructure + licensing)                          â”‚       â”‚
â”‚   â”‚   â””â”€â”€ Development Velocity (ease of changes)                     â”‚       â”‚
â”‚   â”‚                                                                  â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Key Questions for Database Architecture</h3>
<p>Before making database decisions, answer these fundamental questions:</p>
<table><thead><tr><th>Question</th><th>Implications</th></tr></thead><tbody><tr><td>What is the data structure?</td><td>Relational vs Document vs Graph</td></tr><tr><td>What are the access patterns?</td><td>Read-heavy vs Write-heavy</td></tr><tr><td>What consistency is required?</td><td>Strong vs Eventual</td></tr><tr><td>What is the expected data volume?</td><td>Scaling strategy</td></tr><tr><td>What is the query complexity?</td><td>Indexing and optimization needs</td></tr><tr><td>What are the availability requirements?</td><td>Replication strategy</td></tr><tr><td>What are the latency requirements?</td><td>Caching and distribution</td></tr><tr><td>What compliance requirements exist?</td><td>Security and audit needs</td></tr></tbody></table>
<hr>
<h2>9.2 Database Types and Selection Criteria</h2>
<h3>Overview of Database Categories</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                         DATABASE TYPE LANDSCAPE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        RELATIONAL (SQL)                              â”‚   â”‚
â”‚   â”‚   PostgreSQL, MySQL, Oracle, SQL Server, SQLite                      â”‚   â”‚
â”‚   â”‚   Best for: Structured data, complex queries, ACID transactions      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚    DOCUMENT         â”‚  â”‚    KEY-VALUE        â”‚  â”‚   COLUMN-FAMILY  â”‚   â”‚
â”‚   â”‚    MongoDB          â”‚  â”‚    Redis            â”‚  â”‚   Cassandra      â”‚   â”‚
â”‚   â”‚    CouchDB          â”‚  â”‚    DynamoDB         â”‚  â”‚   HBase          â”‚   â”‚
â”‚   â”‚    Firestore        â”‚  â”‚    Memcached        â”‚  â”‚   ScyllaDB       â”‚   â”‚
â”‚   â”‚                     â”‚  â”‚    etcd             â”‚  â”‚                  â”‚   â”‚
â”‚   â”‚   Best for:         â”‚  â”‚   Best for:         â”‚  â”‚   Best for:      â”‚   â”‚
â”‚   â”‚   Flexible schemas  â”‚  â”‚   Caching, sessions â”‚  â”‚   Time-series    â”‚   â”‚
â”‚   â”‚   Nested data       â”‚  â”‚   Simple lookups    â”‚  â”‚   High write vol â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚    GRAPH            â”‚  â”‚    TIME-SERIES      â”‚  â”‚   SEARCH ENGINE  â”‚   â”‚
â”‚   â”‚    Neo4j            â”‚  â”‚    InfluxDB         â”‚  â”‚   Elasticsearch  â”‚   â”‚
â”‚   â”‚    Amazon Neptune   â”‚  â”‚    TimescaleDB      â”‚  â”‚   Solr           â”‚   â”‚
â”‚   â”‚    JanusGraph       â”‚  â”‚    QuestDB          â”‚  â”‚   Meilisearch    â”‚   â”‚
â”‚   â”‚                     â”‚  â”‚    Prometheus       â”‚  â”‚                  â”‚   â”‚
â”‚   â”‚   Best for:         â”‚  â”‚   Best for:         â”‚  â”‚   Best for:      â”‚   â”‚
â”‚   â”‚   Relationships     â”‚  â”‚   Metrics, IoT      â”‚  â”‚   Full-text      â”‚   â”‚
â”‚   â”‚   Network data      â”‚  â”‚   Event data        â”‚  â”‚   Faceted search â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        NewSQL DATABASES                              â”‚   â”‚
â”‚   â”‚   CockroachDB, TiDB, Spanner, YugabyteDB, VoltDB                     â”‚   â”‚
â”‚   â”‚   Best for: Distributed ACID transactions, global scale              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Detailed Database Type Comparison</h3>
<h4>9.2.1 Relational Databases (RDBMS)</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                         RELATIONAL DATABASES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Data organized in tables with rows and columns, relationships defined      â”‚
â”‚  through foreign keys, queried using SQL                                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  USERS TABLE              ORDERS TABLE                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ id â”‚ name   â”‚ email â”‚  â”‚ id â”‚ user_id â”‚ amount â”‚ status â”‚       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚   â”‚
â”‚  â”‚  â”‚ 1  â”‚ Alice  â”‚ a@... â”‚  â”‚ 1  â”‚    1    â”‚ 99.99  â”‚ paid   â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ 2  â”‚ Bob    â”‚ b@... â”‚  â”‚ 2  â”‚    1    â”‚ 49.99  â”‚ shippedâ”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ 3  â”‚    2    â”‚ 149.99 â”‚ pendingâ”‚       â”‚   â”‚
â”‚  â”‚         â–²                 â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚         â”‚                           â”‚                               â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚  â”‚              Foreign Key Relationship                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ ACID compliance                   âœ— Horizontal scaling challenges        â”‚
â”‚  âœ“ Complex queries (JOINs)           âœ— Rigid schema                         â”‚
â”‚  âœ“ Data integrity constraints        âœ— Object-relational impedance          â”‚
â”‚  âœ“ Mature ecosystem                  âœ— Can be overkill for simple data      â”‚
â”‚  âœ“ Strong consistency                âœ— Schema migrations can be painful     â”‚
â”‚  âœ“ Well understood                                                          â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Financial systems requiring transactions                                 â”‚
â”‚  â€¢ Applications with complex relationships                                  â”‚
â”‚  â€¢ Reporting and analytics with complex queries                             â”‚
â”‚  â€¢ Systems requiring strong data integrity                                  â”‚
â”‚  â€¢ Traditional business applications (ERP, CRM)                             â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ PostgreSQL - Feature-rich, extensible, open source                       â”‚
â”‚  â€¢ MySQL - Widely deployed, good performance                                â”‚
â”‚  â€¢ Oracle - Enterprise features, high cost                                  â”‚
â”‚  â€¢ SQL Server - Microsoft ecosystem integration                             â”‚
â”‚  â€¢ SQLite - Embedded, serverless, lightweight                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h4>9.2.2 Document Databases</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          DOCUMENT DATABASES                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Data stored as self-describing documents (JSON, BSON, XML) in collections  â”‚
â”‚  No fixed schema required, documents can have different structures          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  USERS COLLECTION                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ {                                                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   "_id": "user_001",                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   "name": "Alice",                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   "email": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f0919c999395b09588919d809c95de939f9d">[email&#160;protected]</a>",                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   "address": {                     â† Nested object           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚     "street": "123 Main St",                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚     "city": "Boston"                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   },                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   "orders": [                      â† Embedded array          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚     {"id": "ord_1", "amount": 99.99},                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚     {"id": "ord_2", "amount": 49.99}                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   ]                                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ }                                                            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ Flexible schema                   âœ— No JOINs (or limited)                â”‚
â”‚  âœ“ Natural for hierarchical data     âœ— Data duplication                     â”‚
â”‚  âœ“ Horizontal scaling                âœ— Eventual consistency (often)         â”‚
â”‚  âœ“ Developer friendly (JSON)         âœ— Complex transactions limited         â”‚
â”‚  âœ“ Fast reads for document access    âœ— Query optimization harder            â”‚
â”‚  âœ“ Schema evolution easier                                                  â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Content management systems                                               â”‚
â”‚  â€¢ User profiles and personalization                                        â”‚
â”‚  â€¢ Product catalogs with varying attributes                                 â”‚
â”‚  â€¢ Real-time analytics                                                      â”‚
â”‚  â€¢ Mobile application backends                                              â”‚
â”‚  â€¢ Rapid prototyping                                                        â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ MongoDB - Most popular, rich query language                              â”‚
â”‚  â€¢ CouchDB - HTTP/REST API, offline-first                                   â”‚
â”‚  â€¢ Amazon DocumentDB - MongoDB-compatible managed                           â”‚
â”‚  â€¢ Firestore - Real-time sync, mobile-focused                               â”‚
â”‚  â€¢ RavenDB - .NET ecosystem, ACID transactions                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h4>9.2.3 Key-Value Stores</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          KEY-VALUE STORES                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Simplest data model - store and retrieve values by unique keys             â”‚
â”‚  Value can be any data type (string, JSON, binary blob)                     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    KEY                        VALUE                                 â”‚   â”‚
â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚   â”‚
â”‚  â”‚    "user:1001:session"   â†’    "eyJhbGciOiJIUzI1NiIs..."            â”‚   â”‚
â”‚  â”‚    "cart:user:1001"      â†’    {"items": [...], "total": 299.99}    â”‚   â”‚
â”‚  â”‚    "rate_limit:ip:1.2.3" â†’    "47"                                 â”‚   â”‚
â”‚  â”‚    "config:feature:dark" â†’    "true"                               â”‚   â”‚
â”‚  â”‚    "cache:product:5001"  â†’    {full product JSON}                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Operations: GET, SET, DELETE, EXISTS, EXPIRE                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ Extremely fast (O(1) lookups)     âœ— No complex queries                   â”‚
â”‚  âœ“ Simple API                        âœ— No relationships                     â”‚
â”‚  âœ“ Highly scalable                   âœ— Limited data modeling                â”‚
â”‚  âœ“ Low latency                       âœ— Application manages structure        â”‚
â”‚  âœ“ Great for caching                 âœ— No secondary indexes (usually)       â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Session management                                                       â”‚
â”‚  â€¢ Caching layer                                                            â”‚
â”‚  â€¢ Shopping carts                                                           â”‚
â”‚  â€¢ Real-time leaderboards                                                   â”‚
â”‚  â€¢ Rate limiting                                                            â”‚
â”‚  â€¢ Feature flags                                                            â”‚
â”‚  â€¢ Pub/sub messaging                                                        â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ Redis - In-memory, rich data structures, Lua scripting                   â”‚
â”‚  â€¢ Amazon DynamoDB - Managed, auto-scaling, serverless                      â”‚
â”‚  â€¢ Memcached - Simple, distributed caching                                  â”‚
â”‚  â€¢ etcd - Distributed, consistent, for config/coordination                  â”‚
â”‚  â€¢ Riak - Distributed, fault-tolerant                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h4>9.2.4 Column-Family Stores</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                        COLUMN-FAMILY STORES                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Data organized by columns rather than rows, optimized for reading and      â”‚
â”‚  writing large amounts of data across many machines                         â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ROW-ORIENTED (Traditional)     COLUMN-ORIENTED                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ Row1: id,name,email,age â”‚    â”‚ id:    1,2,3,4,5,6...   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Row2: id,name,email,age â”‚    â”‚ name:  A,B,C,D,E,F...   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Row3: id,name,email,age â”‚    â”‚ email: a@,b@,c@,d@...   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Row4: id,name,email,age â”‚    â”‚ age:   25,30,28,35...   â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Better for: OLTP, single       Better for: Analytics,              â”‚   â”‚
â”‚  â”‚  record access                  aggregations, compression           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  WIDE-COLUMN STORE STRUCTURE:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Row Key    â”‚ Column Family: Profile  â”‚ Column Family: Activity    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  user:1001  â”‚ name:Alice, email:a@... â”‚ login:ts1, click:ts2       â”‚   â”‚
â”‚  â”‚  user:1002  â”‚ name:Bob                â”‚ login:ts3, purchase:ts4    â”‚   â”‚
â”‚  â”‚  user:1003  â”‚ name:Carol, phone:555   â”‚ login:ts5                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ Massive write throughput          âœ— Complex data modeling                â”‚
â”‚  âœ“ Linear horizontal scaling         âœ— Limited query flexibility            â”‚
â”‚  âœ“ Excellent compression             âœ— No JOINs                             â”‚
â”‚  âœ“ Time-series optimization          âœ— Eventual consistency                 â”‚
â”‚  âœ“ High availability                 âœ— Steep learning curve                 â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Time-series data (IoT, metrics)                                          â”‚
â”‚  â€¢ Event logging at scale                                                   â”‚
â”‚  â€¢ Content management systems                                               â”‚
â”‚  â€¢ Messaging platforms                                                      â”‚
â”‚  â€¢ Recommendation engines                                                   â”‚
â”‚  â€¢ Write-heavy workloads                                                    â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ Apache Cassandra - Peer-to-peer, highly available                        â”‚
â”‚  â€¢ Apache HBase - Hadoop ecosystem, strong consistency                      â”‚
â”‚  â€¢ ScyllaDB - Cassandra-compatible, better performance                      â”‚
â”‚  â€¢ Google Bigtable - Managed, massive scale                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h4>9.2.5 Graph Databases</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          GRAPH DATABASES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Data modeled as nodes (entities) and edges (relationships)                 â”‚
â”‚  Optimized for traversing relationships between entities                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WORKS_AT     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚        â”‚  Alice  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  TechCorp â”‚                   â”‚   â”‚
â”‚  â”‚        â”‚ (User)  â”‚                 â”‚ (Company) â”‚                   â”‚   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â”‚             â”‚                            â†‘                         â”‚   â”‚
â”‚  â”‚   FRIENDS   â”‚                            â”‚ WORKS_AT                â”‚   â”‚
â”‚  â”‚   WITH      â”‚                            â”‚                         â”‚   â”‚
â”‚  â”‚             â†“                            â”‚                         â”‚   â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    KNOWS        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚  â”‚        â”‚   Bob   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  Carol  â”‚                     â”‚   â”‚
â”‚  â”‚        â”‚ (User)  â”‚  since: 2020    â”‚ (User)  â”‚                     â”‚   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   Nodes have: Labels, Properties                                    â”‚   â”‚
â”‚  â”‚   Edges have: Type, Direction, Properties                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ Relationship traversal O(1)       âœ— Not for simple CRUD                  â”‚
â”‚  âœ“ Flexible schema                   âœ— Horizontal scaling challenges        â”‚
â”‚  âœ“ Intuitive data modeling           âœ— Smaller ecosystem                    â”‚
â”‚  âœ“ Complex relationship queries      âœ— Different query paradigm             â”‚
â”‚  âœ“ Pattern matching                  âœ— Can be overkill for simple data      â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Social networks                                                          â”‚
â”‚  â€¢ Recommendation engines                                                   â”‚
â”‚  â€¢ Fraud detection                                                          â”‚
â”‚  â€¢ Knowledge graphs                                                         â”‚
â”‚  â€¢ Network/IT operations                                                    â”‚
â”‚  â€¢ Identity and access management                                           â”‚
â”‚  â€¢ Supply chain management                                                  â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ Neo4j - Most popular, Cypher query language                              â”‚
â”‚  â€¢ Amazon Neptune - Managed, supports Gremlin and SPARQL                    â”‚
â”‚  â€¢ JanusGraph - Distributed, open source                                    â”‚
â”‚  â€¢ ArangoDB - Multi-model (graph + document)                                â”‚
â”‚  â€¢ TigerGraph - Analytics-focused, parallel processing                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h4>9.2.6 Time-Series Databases</h4>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       TIME-SERIES DATABASES                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CORE CONCEPT:                                                              â”‚
â”‚  Optimized for storing and querying time-stamped data points                â”‚
â”‚  Built-in functions for time-based aggregations and downsampling            â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  MEASUREMENT: cpu_usage                                             â”‚   â”‚
â”‚  â”‚  TAGS: host=server01, region=us-east                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  TIME                    VALUE    Additional Fields                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚   â”‚
â”‚  â”‚  2024-01-15T10:00:00Z    45.2     core=0                            â”‚   â”‚
â”‚  â”‚  2024-01-15T10:00:01Z    47.8     core=0                            â”‚   â”‚
â”‚  â”‚  2024-01-15T10:00:02Z    52.1     core=0                            â”‚   â”‚
â”‚  â”‚  2024-01-15T10:00:03Z    48.9     core=0                            â”‚   â”‚
â”‚  â”‚  ...millions of rows...                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Common Operations:                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Aggregate by time window (1min, 1hr, 1day)                       â”‚   â”‚
â”‚  â”‚  â€¢ Calculate moving averages                                        â”‚   â”‚
â”‚  â”‚  â€¢ Downsample old data                                              â”‚   â”‚
â”‚  â”‚  â€¢ Retention policies (auto-delete old data)                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  STRENGTHS:                          WEAKNESSES:                            â”‚
â”‚  âœ“ Optimized for time-range queries  âœ— Limited to time-series patterns      â”‚
â”‚  âœ“ Efficient compression             âœ— Not for general-purpose data         â”‚
â”‚  âœ“ Built-in downsampling             âœ— Complex JOINs not supported          â”‚
â”‚  âœ“ High write throughput             âœ— Updates are expensive                â”‚
â”‚  âœ“ Automatic data retention          âœ— Smaller community (varies)           â”‚
â”‚                                                                             â”‚
â”‚  BEST USE CASES:                                                            â”‚
â”‚  â€¢ Application metrics and monitoring                                       â”‚
â”‚  â€¢ IoT sensor data                                                          â”‚
â”‚  â€¢ Financial market data                                                    â”‚
â”‚  â€¢ Log aggregation                                                          â”‚
â”‚  â€¢ Real-time analytics                                                      â”‚
â”‚  â€¢ DevOps observability                                                     â”‚
â”‚                                                                             â”‚
â”‚  POPULAR OPTIONS:                                                           â”‚
â”‚  â€¢ InfluxDB - Popular, purpose-built                                        â”‚
â”‚  â€¢ TimescaleDB - PostgreSQL extension, SQL support                          â”‚
â”‚  â€¢ Prometheus - Monitoring-focused, pull model                              â”‚
â”‚  â€¢ QuestDB - High-performance, SQL support                                  â”‚
â”‚  â€¢ Amazon Timestream - Managed, serverless                                  â”‚
â”‚  â€¢ ClickHouse - Analytics-focused, columnar                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Database Selection Decision Matrix</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    DATABASE SELECTION DECISION MATRIX                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  REQUIREMENT              â”‚ RECOMMENDED TYPE                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Complex transactions     â”‚ Relational (PostgreSQL, MySQL)                  â”‚
â”‚  Flexible schema          â”‚ Document (MongoDB, CouchDB)                     â”‚
â”‚  Simple key lookups       â”‚ Key-Value (Redis, DynamoDB)                     â”‚
â”‚  Relationship traversal   â”‚ Graph (Neo4j, Neptune)                          â”‚
â”‚  Time-stamped data        â”‚ Time-Series (InfluxDB, TimescaleDB)             â”‚
â”‚  Full-text search         â”‚ Search Engine (Elasticsearch)                   â”‚
â”‚  High write volume        â”‚ Column-Family (Cassandra)                       â”‚
â”‚  Global distribution      â”‚ NewSQL (CockroachDB, Spanner)                   â”‚
â”‚  Analytics/OLAP           â”‚ Columnar (ClickHouse, Redshift)                 â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚  ACCESS PATTERN           â”‚ OPTIMIZATION                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Read-heavy (90%+ reads)  â”‚ Read replicas, aggressive caching               â”‚
â”‚  Write-heavy (high TPS)   â”‚ Column-family, sharding, async writes           â”‚
â”‚  Mixed workload           â”‚ CQRS pattern, separate read/write stores        â”‚
â”‚  Real-time queries        â”‚ In-memory database, caching layer               â”‚
â”‚  Batch analytics          â”‚ Data warehouse, columnar storage                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.3 The CAP Theorem</h2>
<h3>Understanding CAP</h3>
<p>The CAP theorem, formulated by Eric Brewer, states that a distributed data store can only guarantee two of three properties simultaneously:</p>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                           CAP THEOREM                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                         CONSISTENCY (C)                                     â”‚
â”‚                              â–²                                              â”‚
â”‚                             /â”‚\                                             â”‚
â”‚                            / â”‚ \                                            â”‚
â”‚                           /  â”‚  \                                           â”‚
â”‚                          /   â”‚   \                                          â”‚
â”‚                         /    â”‚    \                                         â”‚
â”‚                        /  CA â”‚ CP  \                                        â”‚
â”‚                       /      â”‚      \                                       â”‚
â”‚                      /       â”‚       \                                      â”‚
â”‚                     /â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€\                                     â”‚
â”‚                    /         â”‚         \                                    â”‚
â”‚                   /    AP    â”‚          \                                   â”‚
â”‚                  /           â”‚           \                                  â”‚
â”‚                 â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼                                 â”‚
â”‚        AVAILABILITY (A)              PARTITION                              â”‚
â”‚                                    TOLERANCE (P)                            â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  CONSISTENCY (C):                                                           â”‚
â”‚  Every read receives the most recent write or an error                      â”‚
â”‚  All nodes see the same data at the same time                               â”‚
â”‚                                                                             â”‚
â”‚  AVAILABILITY (A):                                                          â”‚
â”‚  Every request receives a response (success or failure)                     â”‚
â”‚  System remains operational even if some nodes fail                         â”‚
â”‚                                                                             â”‚
â”‚  PARTITION TOLERANCE (P):                                                   â”‚
â”‚  System continues to operate despite network partitions                     â”‚
â”‚  Messages between nodes can be lost or delayed                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>CAP Trade-off Categories</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                         CAP TRADE-OFF CHOICES                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CP SYSTEMS (Consistency + Partition Tolerance)                       â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚ â”‚
â”‚  â”‚  Sacrifice: Availability during partitions                            â”‚ â”‚
â”‚  â”‚  Behavior: Refuse to respond rather than return stale data            â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Examples: MongoDB (in certain configs), HBase, Redis Cluster,        â”‚ â”‚
â”‚  â”‚            etcd, Zookeeper, Consul                                    â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Use when: Correctness is critical (financial, inventory)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  AP SYSTEMS (Availability + Partition Tolerance)                      â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚ â”‚
â”‚  â”‚  Sacrifice: Consistency during partitions                             â”‚ â”‚
â”‚  â”‚  Behavior: Return potentially stale data rather than error            â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Examples: Cassandra, CouchDB, DynamoDB, Riak                         â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Use when: Availability is critical (social media, content delivery)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CA SYSTEMS (Consistency + Availability)                              â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚ â”‚
â”‚  â”‚  Sacrifice: Partition tolerance (single node or same network)         â”‚ â”‚
â”‚  â”‚  Behavior: Cannot handle network partitions                           â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Examples: Traditional RDBMS (PostgreSQL, MySQL single-node)          â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  Use when: Single datacenter, network is reliable                     â”‚ â”‚
â”‚  â”‚  Note: In distributed systems, P is usually required                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  IMPORTANT: In modern distributed systems, network partitions WILL         â”‚
â”‚  happen. The real choice is usually between CP and AP.                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Beyond CAP: The PACELC Theorem</h3>
<p>CAP only describes behavior during partitions. PACELC extends this:</p>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          PACELC THEOREM                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  "If there is a Partition (P), how does the system trade off between        â”‚
â”‚   Availability and Consistency (A and C);                                   â”‚
â”‚   Else (E), when operating normally, how does the system trade off          â”‚
â”‚   between Latency and Consistency (L and C)?"                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚           During Partition    â”‚    Normal Operation                 â”‚   â”‚
â”‚  â”‚  Database    (P)â†’(A or C)     â”‚    (E)â†’(L or C)                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚   â”‚
â”‚  â”‚  Cassandra      PA            â”‚         EL                          â”‚   â”‚
â”‚  â”‚  DynamoDB       PA            â”‚         EL                          â”‚   â”‚
â”‚  â”‚  MongoDB        PC            â”‚         EC                          â”‚   â”‚
â”‚  â”‚  HBase          PC            â”‚         EC                          â”‚   â”‚
â”‚  â”‚  PostgreSQL     PC            â”‚         EC                          â”‚   â”‚
â”‚  â”‚  CockroachDB    PC            â”‚         EC                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  PA/EL = Prioritize availability and low latency                            â”‚
â”‚  PC/EC = Prioritize consistency always                                      â”‚
â”‚  PA/EC = Available during partition, consistent otherwise (rare)            â”‚
â”‚  PC/EL = Consistent during partition, low latency otherwise (rare)          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.4 ACID vs BASE Consistency Models</h2>
<h3>ACID Properties</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          ACID PROPERTIES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Traditional relational databases guarantee ACID properties:                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  A - ATOMICITY                                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚   â”‚
â”‚  â”‚  "All or nothing"                                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Transaction: Transfer $100 from Account A to Account B             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 1: Deduct $100 from A  â”€â”€â”                                    â”‚   â”‚
â”‚  â”‚  Step 2: Add $100 to B      â”€â”€â”€â”¼â”€â”€ Both succeed OR both fail        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  If Step 2 fails, Step 1 is rolled back                             â”‚   â”‚
â”‚  â”‚  No partial updates are visible                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  C - CONSISTENCY                                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚   â”‚
â”‚  â”‚  "Valid state to valid state"                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Database enforces all defined rules:                               â”‚   â”‚
â”‚  â”‚  â€¢ Primary key constraints                                          â”‚   â”‚
â”‚  â”‚  â€¢ Foreign key relationships                                        â”‚   â”‚
â”‚  â”‚  â€¢ Check constraints                                                â”‚   â”‚
â”‚  â”‚  â€¢ Unique constraints                                               â”‚   â”‚
â”‚  â”‚  â€¢ Triggers and stored procedures                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Transaction cannot leave database in invalid state                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  I - ISOLATION                                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚   â”‚
â”‚  â”‚  "Transactions don't interfere"                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Concurrent transactions appear to execute serially                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Transaction 1          Transaction 2                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚   â”‚
â”‚  â”‚  Read balance: $100                                                 â”‚   â”‚
â”‚  â”‚                         Read balance: $100                          â”‚   â”‚
â”‚  â”‚  Withdraw $50                                                       â”‚   â”‚
â”‚  â”‚  Balance: $50                                                       â”‚   â”‚
â”‚  â”‚                         Withdraw $60 â†’ BLOCKED or FAILS             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Without isolation: Both withdrawals might succeed (overdraft!)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  D - DURABILITY                                                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚   â”‚
â”‚  â”‚  "Committed data survives failures"                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Once transaction commits:                                          â”‚   â”‚
â”‚  â”‚  â€¢ Data is written to persistent storage                            â”‚   â”‚
â”‚  â”‚  â€¢ Survives power failures                                          â”‚   â”‚
â”‚  â”‚  â€¢ Survives system crashes                                          â”‚   â”‚
â”‚  â”‚  â€¢ Can be recovered from backups                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Implemented via: Write-ahead logging (WAL), transaction logs       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Isolation Levels</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                     TRANSACTION ISOLATION LEVELS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  From lowest to highest isolation (and performance impact):                 â”‚
â”‚                                                                             â”‚
â”‚  LEVEL              â”‚ DIRTY â”‚ NON-REPEAT â”‚ PHANTOM â”‚ PERFORMANCE            â”‚
â”‚                     â”‚ READ  â”‚ READ       â”‚ READ    â”‚                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚  READ UNCOMMITTED   â”‚  Yes  â”‚    Yes     â”‚   Yes   â”‚ Highest                â”‚
â”‚  READ COMMITTED     â”‚  No   â”‚    Yes     â”‚   Yes   â”‚ High                   â”‚
â”‚  REPEATABLE READ    â”‚  No   â”‚    No      â”‚   Yes   â”‚ Medium                 â”‚
â”‚  SERIALIZABLE       â”‚  No   â”‚    No      â”‚   No    â”‚ Lowest                 â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  DIRTY READ:                                                                â”‚
â”‚  Reading uncommitted changes from another transaction                       â”‚
â”‚  T1: UPDATE balance = 50 (not committed)                                    â”‚
â”‚  T2: SELECT balance â†’ sees 50 (dirty!)                                      â”‚
â”‚  T1: ROLLBACK â†’ balance is actually 100                                     â”‚
â”‚                                                                             â”‚
â”‚  NON-REPEATABLE READ:                                                       â”‚
â”‚  Same query returns different results within a transaction                  â”‚
â”‚  T1: SELECT balance â†’ 100                                                   â”‚
â”‚  T2: UPDATE balance = 50; COMMIT                                            â”‚
â”‚  T1: SELECT balance â†’ 50 (different!)                                       â”‚
â”‚                                                                             â”‚
â”‚  PHANTOM READ:                                                              â”‚
â”‚  New rows appear in repeated range queries                                  â”‚
â”‚  T1: SELECT COUNT(*) WHERE age &gt; 20 â†’ 5                                     â”‚
â”‚  T2: INSERT INTO users (age=25); COMMIT                                     â”‚
â”‚  T1: SELECT COUNT(*) WHERE age &gt; 20 â†’ 6 (phantom!)                          â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  OPTIMIZATION TIP:                                                          â”‚
â”‚  Use the lowest isolation level that meets your requirements                â”‚
â”‚  Most applications work fine with READ COMMITTED (PostgreSQL default)       â”‚
â”‚  Only use SERIALIZABLE when absolutely necessary                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>BASE Properties</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          BASE PROPERTIES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Alternative to ACID for distributed systems prioritizing availability:     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  BA - BASICALLY AVAILABLE                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  System guarantees availability (per CAP theorem)                   â”‚   â”‚
â”‚  â”‚  Response guaranteed, even if:                                      â”‚   â”‚
â”‚  â”‚  â€¢ Data might be stale                                              â”‚   â”‚
â”‚  â”‚  â€¢ Response might be partial                                        â”‚   â”‚
â”‚  â”‚  â€¢ Consistency is not guaranteed                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example: Shopping cart shows items, even if inventory              â”‚   â”‚
â”‚  â”‚           count might be slightly outdated                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  S - SOFT STATE                                                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  State of the system may change over time                           â”‚   â”‚
â”‚  â”‚  Even without input, due to eventual consistency                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Application must be designed to handle:                            â”‚   â”‚
â”‚  â”‚  â€¢ Temporary inconsistencies                                        â”‚   â”‚
â”‚  â”‚  â€¢ State that "catches up" eventually                               â”‚   â”‚
â”‚  â”‚  â€¢ Multiple valid states during convergence                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  E - EVENTUAL CONSISTENCY                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  System will become consistent over time                            â”‚   â”‚
â”‚  â”‚  Given no new updates, all replicas will converge                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Timeline:                                                          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º            â”‚   â”‚
â”‚  â”‚  Write    Propagating...    Propagating...    Consistent            â”‚   â”‚
â”‚  â”‚   â”‚       Node A: new       Node B: new       All nodes             â”‚   â”‚
â”‚  â”‚   â”‚       Node B: old       Node C: new       have new              â”‚   â”‚
â”‚  â”‚   â”‚       Node C: old                         value                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Consistency window: Time between write and full propagation        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>ACID vs BASE Comparison</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       ACID vs BASE COMPARISON                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CHARACTERISTIC        â”‚    ACID           â”‚    BASE                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  Consistency model     â”‚ Strong            â”‚ Eventual                       â”‚
â”‚  Availability          â”‚ May sacrifice     â”‚ Prioritized                    â”‚
â”‚  Focus                 â”‚ Correctness       â”‚ Availability                   â”‚
â”‚  Scaling               â”‚ Vertical (mostly) â”‚ Horizontal                     â”‚
â”‚  Data model            â”‚ Rigid schema      â”‚ Flexible schema                â”‚
â”‚  Transaction scope     â”‚ Single database   â”‚ Distributed                    â”‚
â”‚  Conflict resolution   â”‚ Pessimistic locks â”‚ Optimistic/merge               â”‚
â”‚  Implementation        â”‚ Complex           â”‚ Simpler at DB level            â”‚
â”‚  Application logic     â”‚ Simpler           â”‚ Must handle inconsistency      â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO USE ACID:                      WHEN TO USE BASE:                   â”‚
â”‚  â€¢ Financial transactions               â€¢ Social media feeds                â”‚
â”‚  â€¢ Inventory management                 â€¢ Shopping carts                    â”‚
â”‚  â€¢ Booking systems                      â€¢ Session data                      â”‚
â”‚  â€¢ Healthcare records                   â€¢ Analytics/metrics                 â”‚
â”‚  â€¢ Regulatory compliance                â€¢ Content delivery                  â”‚
â”‚  â€¢ Order processing                     â€¢ Real-time collaboration           â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  HYBRID APPROACH (Common in practice):                                      â”‚
â”‚  â€¢ Use ACID for critical transactions (orders, payments)                    â”‚
â”‚  â€¢ Use BASE for non-critical data (analytics, recommendations)              â”‚
â”‚  â€¢ Implement saga pattern for distributed transactions                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.5 Data Modeling Strategies</h2>
<h3>Relational Data Modeling</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    RELATIONAL DATA MODELING                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  NORMALIZATION: Process of organizing data to reduce redundancy             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NORMAL FORMS                                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  1NF - First Normal Form                                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚  â€¢ Eliminate repeating groups                                       â”‚   â”‚
â”‚  â”‚  â€¢ Each cell contains single value                                  â”‚   â”‚
â”‚  â”‚  â€¢ Each row is unique (has primary key)                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  BEFORE:                          AFTER (1NF):                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ ID  â”‚ Phone Numbers      â”‚    â”‚ ID  â”‚ Phone      â”‚              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚   â”‚
â”‚  â”‚  â”‚ 1   â”‚ 555-1234, 555-5678 â”‚    â”‚ 1   â”‚ 555-1234   â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ 1   â”‚ 555-5678   â”‚              â”‚   â”‚
â”‚  â”‚                                   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2NF - Second Normal Form                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚  â€¢ Must be in 1NF                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Remove partial dependencies                                      â”‚   â”‚
â”‚  â”‚  â€¢ Non-key columns depend on entire primary key                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  BEFORE (partial dependency):                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ Order_ID â”‚ Product_IDâ”‚ Product_Nameâ”‚ Quantity    â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ (PK)     â”‚ (PK)      â”‚ (depends on â”‚              â”‚              â”‚   â”‚
â”‚  â”‚  â”‚          â”‚           â”‚  Product_ID â”‚              â”‚              â”‚   â”‚
â”‚  â”‚  â”‚          â”‚           â”‚  only!)     â”‚              â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  AFTER (2NF): Split into two tables                                 â”‚   â”‚
â”‚  â”‚  Products: Product_ID, Product_Name                                 â”‚   â”‚
â”‚  â”‚  Order_Items: Order_ID, Product_ID, Quantity                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3NF - Third Normal Form                                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚  â€¢ Must be in 2NF                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Remove transitive dependencies                                   â”‚   â”‚
â”‚  â”‚  â€¢ Non-key columns don't depend on other non-key columns            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  BEFORE (transitive dependency):                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ Emp_ID   â”‚ Dept_ID   â”‚ Dept_Name  â”‚ Dept_Locationâ”‚              â”‚   â”‚
â”‚  â”‚  â”‚ (PK)     â”‚           â”‚ (depends   â”‚ (depends on  â”‚              â”‚   â”‚
â”‚  â”‚  â”‚          â”‚           â”‚ on Dept_ID)â”‚  Dept_ID)    â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  AFTER (3NF): Split into two tables                                 â”‚   â”‚
â”‚  â”‚  Employees: Emp_ID, Dept_ID                                         â”‚   â”‚
â”‚  â”‚  Departments: Dept_ID, Dept_Name, Dept_Location                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  HIGHER NORMAL FORMS (BCNF, 4NF, 5NF):                                      â”‚
â”‚  â€¢ Rarely needed in practice                                                â”‚
â”‚  â€¢ Address specific edge cases                                              â”‚
â”‚  â€¢ 3NF is sufficient for most applications                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Denormalization Strategies</h3>

<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      DENORMALIZATION STRATEGIES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Denormalization: Intentionally adding redundancy to improve read           â”‚
â”‚  performance at the cost of write complexity and storage                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NORMALIZATION vs DENORMALIZATION                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚              NORMALIZED              DENORMALIZED                   â”‚   â”‚
â”‚  â”‚              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚   â”‚
â”‚  â”‚  Reads       Multiple JOINs          Single table access            â”‚   â”‚
â”‚  â”‚  Writes      Single location         Multiple locations             â”‚   â”‚
â”‚  â”‚  Storage     Minimal                 Redundant                      â”‚   â”‚
â”‚  â”‚  Integrity   Enforced by schema      Application responsibility     â”‚   â”‚
â”‚  â”‚  Updates     Simple                  Must update all copies         â”‚   â”‚
â”‚  â”‚  Complexity  In queries              In application logic           â”‚   â”‚
â”‚  â”‚  Best for    Write-heavy             Read-heavy                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  COMMON DENORMALIZATION TECHNIQUES:                                         â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. DUPLICATING COLUMNS                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  NORMALIZED:                                                        â”‚   â”‚
â”‚  â”‚  Orders: order_id, customer_id, amount                              â”‚   â”‚
â”‚  â”‚  Customers: customer_id, customer_name, email                       â”‚   â”‚
â”‚  â”‚  Query: SELECT o.*, c.customer_name FROM Orders o                   â”‚   â”‚
â”‚  â”‚         JOIN Customers c ON o.customer_id = c.customer_id           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  DENORMALIZED:                                                      â”‚   â”‚
â”‚  â”‚  Orders: order_id, customer_id, customer_name, amount               â”‚   â”‚
â”‚  â”‚  Query: SELECT * FROM Orders WHERE order_id = ?                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Trade-off: Faster reads, but must update customer_name in          â”‚   â”‚
â”‚  â”‚             Orders table when customer changes name                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. PRE-COMPUTED AGGREGATES                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Instead of: SELECT COUNT(*) FROM orders WHERE customer_id = ?      â”‚   â”‚
â”‚  â”‚              SELECT SUM(amount) FROM orders WHERE customer_id = ?   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Store in Customers table:                                          â”‚   â”‚
â”‚  â”‚  â€¢ total_orders (count)                                             â”‚   â”‚
â”‚  â”‚  â€¢ total_spent (sum)                                                â”‚   â”‚
â”‚  â”‚  â€¢ last_order_date                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Update these values when orders are created/modified               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. MATERIALIZED VIEWS                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Pre-computed query results stored as a table                       â”‚   â”‚
â”‚  â”‚  Refreshed periodically or on-demand                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Complex queries become simple lookups                            â”‚   â”‚
â”‚  â”‚  â€¢ Reduces load on source tables                                    â”‚   â”‚
â”‚  â”‚  â€¢ Can be indexed independently                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Refresh strategies:                                                â”‚   â”‚
â”‚  â”‚  â€¢ Complete refresh (rebuild entire view)                           â”‚   â”‚
â”‚  â”‚  â€¢ Incremental refresh (update changed rows)                        â”‚   â”‚
â”‚  â”‚  â€¢ On-demand (manual trigger)                                       â”‚   â”‚
â”‚  â”‚  â€¢ Scheduled (every N minutes/hours)                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. EMBEDDING RELATED DATA                                          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Store related data in JSON/JSONB columns                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example - Order with line items:                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ order_id â”‚ customer_id â”‚ line_items (JSONB)               â”‚    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚   â”‚
â”‚  â”‚  â”‚ 1001     â”‚ 42          â”‚ [{"sku": "A1", "qty": 2,         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          â”‚             â”‚   "price": 29.99},               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          â”‚             â”‚  {"sku": "B2", "qty": 1,         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          â”‚             â”‚   "price": 49.99}]               â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Best for: Data that's always accessed together                     â”‚   â”‚
â”‚  â”‚  Avoid for: Data that needs independent querying                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO DENORMALIZE:                                                       â”‚
â”‚  âœ“ Read performance is critical and proven bottleneck                       â”‚
â”‚  âœ“ JOINs are expensive (large tables, complex queries)                      â”‚
â”‚  âœ“ Data is read much more often than written                                â”‚
â”‚  âœ“ Acceptable staleness in duplicated data                                  â”‚
â”‚  âœ“ Application can handle update complexity                                 â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO STAY NORMALIZED:                                                   â”‚
â”‚  âœ“ Write-heavy workloads                                                    â”‚
â”‚  âœ“ Data integrity is paramount                                              â”‚
â”‚  âœ“ Storage costs are a concern                                              â”‚
â”‚  âœ“ Data changes frequently                                                  â”‚
â”‚  âœ“ Simpler application logic preferred                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Document Data Modeling</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      DOCUMENT DATA MODELING                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Document databases require different modeling mindset:                     â”‚
â”‚  "Model for queries, not for storage"                                       â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  EMBEDDING vs REFERENCING                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  EMBEDDING (Denormalized)         REFERENCING (Normalized)          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  {                                {                                 â”‚   â”‚
â”‚  â”‚    "_id": "order_1",                "_id": "order_1",               â”‚   â”‚
â”‚  â”‚    "customer": {                    "customer_id": "cust_42",       â”‚   â”‚
â”‚  â”‚      "name": "Alice",               "items": [                      â”‚   â”‚
â”‚  â”‚      "email": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f495b496da979b99">[email&#160;protected]</a>"               "item_1001",                  â”‚   â”‚
â”‚  â”‚    },                                 "item_1002"                   â”‚   â”‚
â”‚  â”‚    "items": [                       ]                               â”‚   â”‚
â”‚  â”‚      {                            }                                 â”‚   â”‚
â”‚  â”‚        "product": "Widget",                                         â”‚   â”‚
â”‚  â”‚        "price": 29.99             Requires additional queries       â”‚   â”‚
â”‚  â”‚      }                            to fetch customer and items       â”‚   â”‚
â”‚  â”‚    ]                                                                â”‚   â”‚
â”‚  â”‚  }                                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Single query retrieves                                             â”‚   â”‚
â”‚  â”‚  complete order                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  EMBEDDING DECISION CRITERIA:                                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  FAVOR EMBEDDING WHEN:              FAVOR REFERENCING WHEN:         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚   â”‚
â”‚  â”‚  â€¢ "Contains" relationship          â€¢ "References" relationship     â”‚   â”‚
â”‚  â”‚  â€¢ One-to-few relationship          â€¢ One-to-many (unbounded)       â”‚   â”‚
â”‚  â”‚  â€¢ Data accessed together           â€¢ Data accessed separately      â”‚   â”‚
â”‚  â”‚  â€¢ Child data rarely changes        â€¢ Child data changes often      â”‚   â”‚
â”‚  â”‚  â€¢ Document size stays bounded      â€¢ Would exceed 16MB limit       â”‚   â”‚
â”‚  â”‚  â€¢ Need atomic updates              â€¢ Need to query children alone  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  EXAMPLES:                          EXAMPLES:                       â”‚   â”‚
â”‚  â”‚  â€¢ Order â†’ Line Items               â€¢ User â†’ Posts (thousands)      â”‚   â”‚
â”‚  â”‚  â€¢ Blog Post â†’ Comments (few)       â€¢ Product â†’ Reviews (many)      â”‚   â”‚
â”‚  â”‚  â€¢ User â†’ Addresses                 â€¢ Author â†’ Books                â”‚   â”‚
â”‚  â”‚  â€¢ Product â†’ Specifications         â€¢ Category â†’ Products           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  DOCUMENT MODELING PATTERNS:                                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. SUBSET PATTERN                                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Embed only the most-used subset of related data                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Product Document:                                                  â”‚   â”‚
â”‚  â”‚  {                                                                  â”‚   â”‚
â”‚  â”‚    "_id": "prod_1",                                                 â”‚   â”‚
â”‚  â”‚    "name": "Laptop",                                                â”‚   â”‚
â”‚  â”‚    "price": 999.99,                                                 â”‚   â”‚
â”‚  â”‚    "recent_reviews": [           â† Only last 10 reviews             â”‚   â”‚
â”‚  â”‚      {"rating": 5, "text": "Great!", "date": "2024-01-15"},         â”‚   â”‚
â”‚  â”‚      {"rating": 4, "text": "Good value", "date": "2024-01-14"}      â”‚   â”‚
â”‚  â”‚    ],                                                               â”‚   â”‚
â”‚  â”‚    "review_count": 1547,         â† Total count for reference        â”‚   â”‚
â”‚  â”‚    "avg_rating": 4.3                                                â”‚   â”‚
â”‚  â”‚  }                                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Full reviews stored in separate collection for pagination          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. EXTENDED REFERENCE PATTERN                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Store reference ID plus frequently-needed fields                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Order Document:                                                    â”‚   â”‚
â”‚  â”‚  {                                                                  â”‚   â”‚
â”‚  â”‚    "_id": "order_1",                                                â”‚   â”‚
â”‚  â”‚    "customer": {                                                    â”‚   â”‚
â”‚  â”‚      "_id": "cust_42",           â† Reference for full lookup        â”‚   â”‚
â”‚  â”‚      "name": "Alice Smith",      â† Cached for display               â”‚   â”‚
â”‚  â”‚      "email": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="395855505a5c795c41175a5654">[email&#160;protected]</a>"     â† Cached for notifications         â”‚   â”‚
â”‚  â”‚    },                                                               â”‚   â”‚
â”‚  â”‚    "total": 299.99                                                  â”‚   â”‚
â”‚  â”‚  }                                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Avoids JOIN for common operations                                  â”‚   â”‚
â”‚  â”‚  Must update cached fields when customer changes                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. BUCKET PATTERN                                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Group time-series or sequential data into buckets                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Instead of one document per measurement:                           â”‚   â”‚
â”‚  â”‚  { "sensor": "temp_1", "time": "10:00:01", "value": 72.1 }          â”‚   â”‚
â”‚  â”‚  { "sensor": "temp_1", "time": "10:00:02", "value": 72.3 }          â”‚   â”‚
â”‚  â”‚  ... (millions of documents)                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Bucket by hour:                                                    â”‚   â”‚
â”‚  â”‚  {                                                                  â”‚   â”‚
â”‚  â”‚    "sensor": "temp_1",                                              â”‚   â”‚
â”‚  â”‚    "date": "2024-01-15",                                            â”‚   â”‚
â”‚  â”‚    "hour": 10,                                                      â”‚   â”‚
â”‚  â”‚    "readings": [                                                    â”‚   â”‚
â”‚  â”‚      {"minute": 0, "second": 1, "value": 72.1},                     â”‚   â”‚
â”‚  â”‚      {"minute": 0, "second": 2, "value": 72.3},                     â”‚   â”‚
â”‚  â”‚      ...                                                            â”‚   â”‚
â”‚  â”‚    ],                                                               â”‚   â”‚
â”‚  â”‚    "count": 3600,                                                   â”‚   â”‚
â”‚  â”‚    "sum": 259920,                                                   â”‚   â”‚
â”‚  â”‚    "avg": 72.2                                                      â”‚   â”‚
â”‚  â”‚  }                                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits: Fewer documents, built-in aggregates, efficient queries  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. POLYMORPHIC PATTERN                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Store different types in same collection with type discriminator   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Vehicles Collection:                                               â”‚   â”‚
â”‚  â”‚  { "type": "car", "make": "Toyota", "doors": 4, "fuel": "hybrid" }  â”‚   â”‚
â”‚  â”‚  { "type": "motorcycle", "make": "Honda", "cc": 650 }               â”‚   â”‚
â”‚  â”‚  { "type": "truck", "make": "Ford", "payload_tons": 2.5 }           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query all vehicles or filter by type                               â”‚   â”‚
â”‚  â”‚  Application handles type-specific fields                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.6 Database Scaling Strategies</h2>
<h3>Vertical vs Horizontal Scaling</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      DATABASE SCALING APPROACHES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  VERTICAL SCALING (Scale Up)                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚  â”‚       â”‚ Server  â”‚   â†’     â”‚   BIGGER    â”‚                           â”‚   â”‚
â”‚  â”‚       â”‚ 4 CPU   â”‚         â”‚   SERVER    â”‚                           â”‚   â”‚
â”‚  â”‚       â”‚ 16 GB   â”‚         â”‚   16 CPU    â”‚                           â”‚   â”‚
â”‚  â”‚       â”‚ 500 GB  â”‚         â”‚   128 GB    â”‚                           â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   2 TB SSD  â”‚                           â”‚   â”‚
â”‚  â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ADVANTAGES:                    DISADVANTAGES:                      â”‚   â”‚
â”‚  â”‚  â€¢ Simple - no code changes     â€¢ Hardware limits (ceiling)         â”‚   â”‚
â”‚  â”‚  â€¢ No distributed complexity    â€¢ Expensive at high end             â”‚   â”‚
â”‚  â”‚  â€¢ ACID transactions easy       â€¢ Single point of failure           â”‚   â”‚
â”‚  â”‚  â€¢ Consistent performance       â€¢ Downtime for upgrades             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  HORIZONTAL SCALING (Scale Out)                                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚       â”‚ Server  â”‚   â†’     â”‚ Server  â”‚ â”‚ Server  â”‚ â”‚ Server  â”‚      â”‚   â”‚
â”‚  â”‚       â”‚         â”‚         â”‚   #1    â”‚ â”‚   #2    â”‚ â”‚   #3    â”‚      â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                  â”‚          â”‚          â”‚            â”‚   â”‚
â”‚  â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                             â”‚                       â”‚   â”‚
â”‚  â”‚                                        Distributed                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ADVANTAGES:                    DISADVANTAGES:                      â”‚   â”‚
â”‚  â”‚  â€¢ Near-infinite scaling        â€¢ Distributed complexity            â”‚   â”‚
â”‚  â”‚  â€¢ Fault tolerance              â€¢ Eventual consistency (often)      â”‚   â”‚
â”‚  â”‚  â€¢ Cost-effective (commodity)   â€¢ Cross-shard queries hard          â”‚   â”‚
â”‚  â”‚  â€¢ Geographic distribution      â€¢ Operational overhead              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  OPTIMIZATION TIP:                                                          â”‚
â”‚  Start with vertical scaling - it's simpler and often sufficient.           â”‚
â”‚  Move to horizontal scaling when:                                           â”‚
â”‚  â€¢ You've hit hardware limits                                               â”‚
â”‚  â€¢ You need geographic distribution                                         â”‚
â”‚  â€¢ You need fault tolerance across zones                                    â”‚
â”‚  â€¢ Cost becomes prohibitive                                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Replication Strategies</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       REPLICATION STRATEGIES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Replication: Maintaining copies of data on multiple nodes                  â”‚
â”‚  Primary goals: High availability, read scaling, disaster recovery          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. PRIMARY-REPLICA (Master-Slave)                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚        WRITES                                                       â”‚   â”‚
â”‚  â”‚           â”‚                                                         â”‚   â”‚
â”‚  â”‚           â–¼                                                         â”‚   â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚   â”‚
â”‚  â”‚      â”‚ PRIMARY â”‚ â”€â”€â”€ Replication Stream â”€â”€â”€â”                        â”‚   â”‚
â”‚  â”‚      â”‚ (Write) â”‚                           â”‚                        â”‚   â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚                        â”‚   â”‚
â”‚  â”‚                                            â–¼                        â”‚   â”‚
â”‚  â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚           READS â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ REPLICA â”‚  â”‚ REPLICA â”‚  â”‚ REPLICA â”‚     â”‚   â”‚
â”‚  â”‚                          â”‚  (Read) â”‚  â”‚  (Read) â”‚  â”‚  (Read) â”‚     â”‚   â”‚
â”‚  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Characteristics:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ All writes go to primary                                         â”‚   â”‚
â”‚  â”‚  â€¢ Reads distributed across replicas                                â”‚   â”‚
â”‚  â”‚  â€¢ Async replication = eventual consistency                         â”‚   â”‚
â”‚  â”‚  â€¢ Sync replication = strong consistency but slower                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Failover: Replica promoted to primary if primary fails             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. PRIMARY-PRIMARY (Multi-Master)                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚   â”‚
â”‚  â”‚      â”‚ PRIMARY â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â–º â”‚ PRIMARY â”‚                              â”‚   â”‚
â”‚  â”‚      â”‚   #1    â”‚  Bi-dir   â”‚   #2    â”‚                              â”‚   â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  Repl.    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚  â”‚           â”‚                     â”‚                                   â”‚   â”‚
â”‚  â”‚        WRITES               WRITES                                  â”‚   â”‚
â”‚  â”‚        READS                READS                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Characteristics:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Writes accepted on any node                                      â”‚   â”‚
â”‚  â”‚  â€¢ Requires conflict resolution strategy                            â”‚   â”‚
â”‚  â”‚  â€¢ Better write availability                                        â”‚   â”‚
â”‚  â”‚  â€¢ More complex to manage                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Conflict Resolution:                                               â”‚   â”‚
â”‚  â”‚  â€¢ Last-write-wins (timestamp)                                      â”‚   â”‚
â”‚  â”‚  â€¢ Application-level resolution                                     â”‚   â”‚
â”‚  â”‚  â€¢ CRDTs (Conflict-free Replicated Data Types)                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  REPLICATION LAG                                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Time between write on primary and visibility on replica            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Primary    Replica A    Replica B                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚  â”‚  Write X                                                            â”‚   â”‚
â”‚  â”‚    â”‚                                                                â”‚   â”‚
â”‚  â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ X (10ms lag)                                        â”‚   â”‚
â”‚  â”‚    â”‚                                                                â”‚   â”‚
â”‚  â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ X (50ms lag)                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Problems caused by lag:                                            â”‚   â”‚
â”‚  â”‚  â€¢ Read-your-writes inconsistency                                   â”‚   â”‚
â”‚  â”‚  â€¢ Stale data in reports                                            â”‚   â”‚
â”‚  â”‚  â€¢ Race conditions in distributed logic                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Mitigation strategies:                                             â”‚   â”‚
â”‚  â”‚  â€¢ Read from primary for critical operations                        â”‚   â”‚
â”‚  â”‚  â€¢ Use synchronous replication (slower)                             â”‚   â”‚
â”‚  â”‚  â€¢ Implement read-your-writes at application level                  â”‚   â”‚
â”‚  â”‚  â€¢ Monitor and alert on excessive lag                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  SYNCHRONOUS vs ASYNCHRONOUS REPLICATION:                                   â”‚
â”‚                                                                             â”‚
â”‚  SYNCHRONOUS:                        ASYNCHRONOUS:                          â”‚
â”‚  â€¢ Write confirmed after replicas    â€¢ Write confirmed immediately          â”‚
â”‚  â€¢ Zero data loss on failover        â€¢ Potential data loss on failover      â”‚
â”‚  â€¢ Higher write latency              â€¢ Lower write latency                  â”‚
â”‚  â€¢ Limited by slowest replica        â€¢ Replicas can fall behind             â”‚
â”‚  â€¢ Strong consistency                â€¢ Eventual consistency                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Sharding (Partitioning) Strategies</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                        SHARDING STRATEGIES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Sharding: Distributing data across multiple database instances             â”‚
â”‚  Each shard holds a subset of the total data                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WHY SHARD?                                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Data too large for single server                                 â”‚   â”‚
â”‚  â”‚  â€¢ Write throughput exceeds single server capacity                  â”‚   â”‚
â”‚  â”‚  â€¢ Geographic data locality requirements                            â”‚   â”‚
â”‚  â”‚  â€¢ Isolation for multi-tenant systems                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. RANGE-BASED SHARDING                                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Data partitioned by ranges of the shard key                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚  Shard 1  â”‚  â”‚  Shard 2  â”‚  â”‚  Shard 3  â”‚  â”‚  Shard 4  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  A - F    â”‚  â”‚  G - L    â”‚  â”‚  M - R    â”‚  â”‚  S - Z    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚           â”‚  â”‚           â”‚  â”‚           â”‚  â”‚           â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Adams     â”‚  â”‚ Garcia    â”‚  â”‚ Miller    â”‚  â”‚ Smith     â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Brown     â”‚  â”‚ Johnson   â”‚  â”‚ Nelson    â”‚  â”‚ Taylor    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Davis     â”‚  â”‚ Lee       â”‚  â”‚ Parker    â”‚  â”‚ Wilson    â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ADVANTAGES:                    DISADVANTAGES:                      â”‚   â”‚
â”‚  â”‚  â€¢ Range queries efficient      â€¢ Hotspots (uneven distribution)    â”‚   â”‚
â”‚  â”‚  â€¢ Easy to understand           â€¢ Sequential inserts hit one shard  â”‚   â”‚
â”‚  â”‚  â€¢ Simple implementation        â€¢ Rebalancing is complex            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Best for: Time-series data, alphabetical data                      â”‚   â”‚
â”‚  â”‚  Avoid for: Auto-increment IDs, timestamps as keys                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. HASH-BASED SHARDING                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Shard determined by hash function: shard = hash(key) % num_shards  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                    hash("user_1234") % 4 = 2                        â”‚   â”‚
â”‚  â”‚                              â”‚                                      â”‚   â”‚
â”‚  â”‚                              â–¼                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚  Shard 0  â”‚  â”‚  Shard 1  â”‚  â”‚  Shard 2  â”‚  â”‚  Shard 3  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚           â”‚  â”‚           â”‚  â”‚  user_1234â”‚  â”‚           â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ user_5678 â”‚  â”‚ user_9012 â”‚  â”‚  user_7777â”‚  â”‚ user_3456 â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ user_2468 â”‚  â”‚ user_1357 â”‚  â”‚           â”‚  â”‚ user_8024 â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ADVANTAGES:                    DISADVANTAGES:                      â”‚   â”‚
â”‚  â”‚  â€¢ Even data distribution       â€¢ Range queries hit all shards      â”‚   â”‚
â”‚  â”‚  â€¢ No hotspots                  â€¢ Adding shards requires rehashing  â”‚   â”‚
â”‚  â”‚  â€¢ Simple routing               â€¢ No data locality                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Best for: Random access patterns, user data by ID                  â”‚   â”‚
â”‚  â”‚  Avoid for: Range queries, sequential access                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. CONSISTENT HASHING                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Minimizes data movement when adding/removing shards                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                    Hash Ring                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                      0Â°                                             â”‚   â”‚
â”‚  â”‚                      â”‚                                              â”‚   â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚   â”‚
â”‚  â”‚             â•±                 â•²                                     â”‚   â”‚
â”‚  â”‚           â•±    Shard A         â•²                                    â”‚   â”‚
â”‚  â”‚    270Â° â”€â”¤                      â”œâ”€ 90Â°                              â”‚   â”‚
â”‚  â”‚           â•²    Shard C         â•±                                    â”‚   â”‚
â”‚  â”‚             â•²                 â•±                                     â”‚   â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚   â”‚
â”‚  â”‚                      â”‚                                              â”‚   â”‚
â”‚  â”‚                    180Â°                                             â”‚   â”‚
â”‚  â”‚                  Shard B                                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Keys hashed to position on ring, served by next clockwise shard    â”‚   â”‚
â”‚  â”‚  Adding shard only affects neighboring shard's data                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Used by: DynamoDB, Cassandra, Riak                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. DIRECTORY-BASED SHARDING                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Lookup table maps keys to shards                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚      Request          Directory              Shards                 â”‚   â”‚
â”‚  â”‚         â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚  â”‚         â”‚  "user_1"  â”‚ user_1â†’Aâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚  â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ user_2â†’Bâ”‚â”€â†’â”‚Shard Aâ”‚                        â”‚   â”‚
â”‚  â”‚         â”‚            â”‚ user_3â†’Aâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚  â”‚         â”‚            â”‚ user_4â†’Câ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚  â”‚         â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚Shard Bâ”‚                        â”‚   â”‚
â”‚  â”‚         â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚  â”‚         â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”                        â”‚   â”‚
â”‚  â”‚         â”‚                         â”‚Shard Câ”‚                        â”‚   â”‚
â”‚  â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ADVANTAGES:                    DISADVANTAGES:                      â”‚   â”‚
â”‚  â”‚  â€¢ Flexible shard assignment    â€¢ Directory is bottleneck/SPOF     â”‚   â”‚
â”‚  â”‚  â€¢ Easy rebalancing             â€¢ Extra lookup latency              â”‚   â”‚
â”‚  â”‚  â€¢ Custom placement logic       â€¢ Directory must be highly availableâ”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. GEO-BASED SHARDING                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Data partitioned by geographic region                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚       â”‚                  WORLD MAP                       â”‚          â”‚   â”‚
â”‚  â”‚       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”             â”‚          â”‚   â”‚
â”‚  â”‚       â”‚    â”‚  US  â”‚    â”‚  EU  â”‚    â”‚ APAC â”‚             â”‚          â”‚   â”‚
â”‚  â”‚       â”‚    â”‚Shard â”‚    â”‚Shard â”‚    â”‚Shard â”‚             â”‚          â”‚   â”‚
â”‚  â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜             â”‚          â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Low latency for local users                                      â”‚   â”‚
â”‚  â”‚  â€¢ Data sovereignty compliance (GDPR)                               â”‚   â”‚
â”‚  â”‚  â€¢ Natural disaster isolation                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Shard Key Selection</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       SHARD KEY SELECTION                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  The shard key is THE MOST CRITICAL decision in sharding architecture       â”‚
â”‚  Wrong choice leads to hotspots, poor query performance, and scaling issues â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CHARACTERISTICS OF A GOOD SHARD KEY                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ HIGH CARDINALITY                                                 â”‚   â”‚
â”‚  â”‚    Many unique values to distribute across shards                   â”‚   â”‚
â”‚  â”‚    Bad: country_code (only ~200 values)                             â”‚   â”‚
â”‚  â”‚    Good: user_id (millions of values)                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ EVEN DISTRIBUTION                                                â”‚   â”‚
â”‚  â”‚    Values should be uniformly distributed                           â”‚   â”‚
â”‚  â”‚    Bad: created_date (recent dates get all traffic)                 â”‚   â”‚
â”‚  â”‚    Good: hash(user_id) (uniform distribution)                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ QUERY ISOLATION                                                  â”‚   â”‚
â”‚  â”‚    Common queries should target single shard                        â”‚   â”‚
â”‚  â”‚    Bad: Querying by email when sharded by user_id                   â”‚   â”‚
â”‚  â”‚    Good: Querying by user_id when sharded by user_id                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ WRITE DISTRIBUTION                                               â”‚   â”‚
â”‚  â”‚    Writes should spread across shards                               â”‚   â”‚
â”‚  â”‚    Bad: Sequential IDs (all inserts hit latest shard)               â”‚   â”‚
â”‚  â”‚    Good: Random UUIDs or hashed keys                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ STABILITY                                                        â”‚   â”‚
â”‚  â”‚    Key value should not change                                      â”‚   â”‚
â”‚  â”‚    Bad: email (users change emails)                                 â”‚   â”‚
â”‚  â”‚    Good: user_id (immutable)                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  COMMON SHARD KEY PATTERNS:                                                 â”‚
â”‚                                                                             â”‚
â”‚  PATTERN              â”‚ USE CASE                â”‚ EXAMPLE                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚  Tenant ID            â”‚ Multi-tenant SaaS       â”‚ company_id                â”‚
â”‚  User ID              â”‚ User-centric apps       â”‚ user_id                   â”‚
â”‚  Geographic           â”‚ Regional data           â”‚ region + user_id          â”‚
â”‚  Time-based           â”‚ Time-series (careful!)  â”‚ year_month + sensor_id    â”‚
â”‚  Compound key         â”‚ Complex access patterns â”‚ tenant_id + user_id       â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸  SHARD KEY ANTI-PATTERNS:                                               â”‚
â”‚                                                                             â”‚
â”‚  âœ— Monotonically increasing values (timestamps, auto-increment)             â”‚
â”‚    â†’ Creates "hot shard" for all new writes                                 â”‚
â”‚                                                                             â”‚
â”‚  âœ— Low cardinality fields (status, country, category)                       â”‚
â”‚    â†’ Limited distribution, large shards                                     â”‚
â”‚                                                                             â”‚
â”‚  âœ— Frequently updated fields                                                â”‚
â”‚    â†’ Requires moving documents between shards                               â”‚
â”‚                                                                             â”‚
â”‚  âœ— Fields not in common queries                                             â”‚
â”‚    â†’ Forces scatter-gather queries                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.7 Indexing Strategies</h2>
<h3>Understanding Database Indexes</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                        DATABASE INDEXING                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Index: Data structure that improves query speed at cost of write overhead  â”‚
â”‚  Like a book's index - find topics without reading every page               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WITHOUT INDEX                      WITH INDEX                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query: WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4b2a0b2965282426">[email&#160;protected]</a>'     Query: WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1b7a5b7935787476">[email&#160;protected]</a>'  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚ Scan ALL rows        â”‚           â”‚ Index Lookup    â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ Row 1: check email   â”‚           â”‚ '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a9c8e9cb87cac6c4">[email&#160;protected]</a>' â†’ Row â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ Row 2: check email   â”‚           â”‚ pointer         â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ Row 3: check email   â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚  â”‚ ...                  â”‚                    â”‚                      â”‚   â”‚
â”‚  â”‚  â”‚ Row N: check email   â”‚                    â–¼                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚                                     â”‚ Direct row fetchâ”‚             â”‚   â”‚
â”‚  â”‚  Time: O(N)                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚  Full table scan                                                    â”‚   â”‚
â”‚  â”‚                                     Time: O(log N)                  â”‚   â”‚
â”‚  â”‚                                     Index + fetch                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  INDEX TRADE-OFFS:                                                          â”‚
â”‚                                                                             â”‚
â”‚  BENEFITS:                             COSTS:                               â”‚
â”‚  â€¢ Faster SELECT queries               â€¢ Slower INSERT/UPDATE/DELETE        â”‚
â”‚  â€¢ Efficient sorting                   â€¢ Additional storage space           â”‚
â”‚  â€¢ Faster JOINs                        â€¢ Index maintenance overhead         â”‚
â”‚  â€¢ Constraint enforcement              â€¢ Memory usage for index cache       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Index Types</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          INDEX TYPES                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. B-TREE INDEX (Most Common)                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Balanced tree structure, excellent for range queries               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                    [M]                    Root                      â”‚   â”‚
â”‚  â”‚                   /   \                                             â”‚   â”‚
â”‚  â”‚                [G]     [T]                Internal                  â”‚   â”‚
â”‚  â”‚               / \       / \                                         â”‚   â”‚
â”‚  â”‚            [A-F][H-L][N-S][U-Z]           Leaf (data pointers)      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Good for: =, &lt;, &gt;, &lt;=, &gt;=, BETWEEN, LIKE 'prefix%'                 â”‚   â”‚
â”‚  â”‚  Used for: Primary keys, foreign keys, most columns                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. HASH INDEX                                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Direct lookup via hash function                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    key â”€â”€â†’ hash() â”€â”€â†’ bucket â”€â”€â†’ value                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Good for: Exact match (=) only                                     â”‚   â”‚
â”‚  â”‚  Not for: Range queries, sorting, partial matches                   â”‚   â”‚
â”‚  â”‚  Used for: In-memory tables, specific equality lookups              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. FULL-TEXT INDEX                                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Inverted index for text search                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Document 1: "The quick brown fox"                                  â”‚   â”‚
â”‚  â”‚  Document 2: "Quick brown dog"                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Inverted Index:                                                    â”‚   â”‚
â”‚  â”‚  "quick" â†’ [Doc1, Doc2]                                             â”‚   â”‚
â”‚  â”‚  "brown" â†’ [Doc1, Doc2]                                             â”‚   â”‚
â”‚  â”‚  "fox"   â†’ [Doc1]                                                   â”‚   â”‚
â”‚  â”‚  "dog"   â†’ [Doc2]                                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Good for: Text search, relevance ranking                           â”‚   â”‚
â”‚  â”‚  Features: Stemming, stop words, phrase search                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. COMPOSITE (MULTI-COLUMN) INDEX                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Index on multiple columns, order matters!                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Index: (last_name, first_name, birth_date)                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Can use for:                                                     â”‚   â”‚
â”‚  â”‚    WHERE last_name = 'Smith'                                        â”‚   â”‚
â”‚  â”‚    WHERE last_name = 'Smith' AND first_name = 'John'                â”‚   â”‚
â”‚  â”‚    WHERE last_name = 'Smith' AND first_name = 'John'                â”‚   â”‚
â”‚  â”‚          AND birth_date = '1990-01-01'                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Cannot efficiently use for:                                      â”‚   â”‚
â”‚  â”‚    WHERE first_name = 'John'           (skips first column)         â”‚   â”‚
â”‚  â”‚    WHERE birth_date = '1990-01-01'     (skips first two columns)    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  RULE: Index can be used left-to-right, no skipping                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. COVERING INDEX                                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Index contains all columns needed by query                         â”‚   â”‚
â”‚  â”‚  Query satisfied entirely from index (no table access)              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query: SELECT email, name FROM users WHERE status = 'active'       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Covering Index: (status, email, name)                              â”‚   â”‚
â”‚  â”‚                   ^^^^^^  ^^^^^^^^^^^                               â”‚   â”‚
â”‚  â”‚                   filter  included columns                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefit: Eliminates random I/O to table                            â”‚   â”‚
â”‚  â”‚  Cost: Larger index, more maintenance                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  6. PARTIAL (FILTERED) INDEX                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Index only subset of rows matching condition                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example: Index only active users                                   â”‚   â”‚
â”‚  â”‚  CREATE INDEX idx_active_users ON users(email)                      â”‚   â”‚
â”‚  â”‚         WHERE status = 'active';                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Smaller index size                                               â”‚   â”‚
â”‚  â”‚  â€¢ Faster maintenance                                               â”‚   â”‚
â”‚  â”‚  â€¢ Better cache utilization                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Use when: Queries always filter by the same condition              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  OTHER INDEX TYPES:                                                         â”‚
â”‚  â€¢ GiST/GIN (PostgreSQL) - Full-text, arrays, JSON                          â”‚
â”‚  â€¢ Spatial indexes - Geographic data (R-tree)                               â”‚
â”‚  â€¢ Bitmap indexes - Low cardinality, data warehouses                        â”‚
â”‚  â€¢ Bloom filters - Probabilistic, existence checks                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Index Optimization Tips</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      INDEX OPTIMIZATION TIPS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 1: INDEX COLUMNS IN WHERE, JOIN, AND ORDER BY                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Analyze your queries:                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  SELECT * FROM orders o                                             â”‚   â”‚
â”‚  â”‚  JOIN customers c ON o.customer_id = c.id    â† Index both sides     â”‚   â”‚
â”‚  â”‚  WHERE o.status = 'pending'                  â† Index candidate      â”‚   â”‚
â”‚  â”‚    AND o.created_at &gt; '2024-01-01'           â† Index candidate      â”‚   â”‚
â”‚  â”‚  ORDER BY o.created_at DESC;                 â† Index can help       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Consider composite: (status, created_at)                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 2: COLUMN ORDER IN COMPOSITE INDEXES                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Order by:                                                          â”‚   â”‚
â”‚  â”‚  1. Equality conditions first (WHERE x = ?)                         â”‚   â”‚
â”‚  â”‚  2. Range conditions last (WHERE y &gt; ?)                             â”‚   â”‚
â”‚  â”‚  3. Most selective columns first                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query: WHERE status = 'active' AND created_at &gt; '2024-01-01'       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Good: (status, created_at)   - equality first                      â”‚   â”‚
â”‚  â”‚  Bad:  (created_at, status)   - range first blocks status use       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 3: AVOID OVER-INDEXING                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Each index:                                                        â”‚   â”‚
â”‚  â”‚  â€¢ Slows down INSERT, UPDATE, DELETE                                â”‚   â”‚
â”‚  â”‚  â€¢ Consumes storage space                                           â”‚   â”‚
â”‚  â”‚  â€¢ Requires maintenance (vacuuming, rebuilding)                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Guidelines:                                                        â”‚   â”‚
â”‚  â”‚  â€¢ Start with no indexes, add based on slow queries                 â”‚   â”‚
â”‚  â”‚  â€¢ Remove unused indexes (monitor index usage)                      â”‚   â”‚
â”‚  â”‚  â€¢ Consolidate overlapping indexes                                  â”‚   â”‚
â”‚  â”‚  â€¢ Balance read vs write performance                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Write-heavy tables: Fewer, targeted indexes                        â”‚   â”‚
â”‚  â”‚  Read-heavy tables: More indexes acceptable                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 4: USE EXPLAIN/ANALYZE                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Always check query execution plans:                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  EXPLAIN ANALYZE SELECT * FROM users WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5c28392f281c3924723f3331">[email&#160;protected]</a>';   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Look for:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Seq Scan (table scan) - might need index                         â”‚   â”‚
â”‚  â”‚  â€¢ Index Scan - good, using index                                   â”‚   â”‚
â”‚  â”‚  â€¢ Index Only Scan - best, covering index                           â”‚   â”‚
â”‚  â”‚  â€¢ Bitmap Heap Scan - multiple indexes combined                     â”‚   â”‚
â”‚  â”‚  â€¢ Estimated vs Actual rows - statistics accuracy                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 5: INDEX MAINTENANCE                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Indexes degrade over time (fragmentation, bloat)                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Maintenance tasks:                                                 â”‚   â”‚
â”‚  â”‚  â€¢ REINDEX - Rebuild fragmented indexes                             â”‚   â”‚
â”‚  â”‚  â€¢ VACUUM (PostgreSQL) - Reclaim space from dead tuples             â”‚   â”‚
â”‚  â”‚  â€¢ ANALYZE - Update statistics for query planner                    â”‚   â”‚
â”‚  â”‚  â€¢ OPTIMIZE TABLE (MySQL) - Defragment and update stats             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Schedule regular maintenance during low-traffic periods            â”‚   â”‚
â”‚  â”‚  Monitor index bloat and fragmentation metrics                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 6: MONITOR INDEX USAGE                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Track which indexes are actually being used:                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  PostgreSQL: pg_stat_user_indexes                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚ index_name     â”‚ idx_scan  â”‚ idx_tup_readâ”‚ idx_tup_fetchâ”‚        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚   â”‚
â”‚  â”‚  â”‚ idx_user_email â”‚ 1,234,567 â”‚ 1,234,567 â”‚ 1,234,567    â”‚ â† Used  â”‚   â”‚
â”‚  â”‚  â”‚ idx_user_phone â”‚ 0         â”‚ 0         â”‚ 0            â”‚ â† DROP! â”‚   â”‚
â”‚  â”‚  â”‚ idx_user_name  â”‚ 45        â”‚ 180       â”‚ 180          â”‚ â† Rare  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Remove indexes with zero or very low usage                         â”‚   â”‚
â”‚  â”‚  Consider if rarely-used indexes are worth the write overhead       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TIP 7: AVOID INDEX-DEFEATING PATTERNS                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  These patterns prevent index usage:                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Functions on indexed columns                                     â”‚   â”‚
â”‚  â”‚    Bad:  WHERE UPPER(email) = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="90c4d5c3c4d0d5c8d1ddc0dcd5bed3dfdd">[email&#160;protected]</a>'                    â”‚   â”‚
â”‚  â”‚    Good: WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="196d7c6a6d597c61787469757c377a7674">[email&#160;protected]</a>'                           â”‚   â”‚
â”‚  â”‚    Or:   Create functional index on UPPER(email)                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Implicit type conversion                                         â”‚   â”‚
â”‚  â”‚    Bad:  WHERE phone = 5551234  (phone is VARCHAR)                  â”‚   â”‚
â”‚  â”‚    Good: WHERE phone = '5551234'                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Leading wildcard in LIKE                                         â”‚   â”‚
â”‚  â”‚    Bad:  WHERE name LIKE '%smith'  (cannot use B-tree)              â”‚   â”‚
â”‚  â”‚    Good: WHERE name LIKE 'smith%'  (can use B-tree)                 â”‚   â”‚
â”‚  â”‚    Or:   Use full-text search for contains queries                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— OR conditions on different columns                               â”‚   â”‚
â”‚  â”‚    Bad:  WHERE email = 'x' OR phone = 'y'                           â”‚   â”‚
â”‚  â”‚    Good: Use UNION or multiple queries                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— NOT IN / NOT EXISTS / != on indexed columns                      â”‚   â”‚
â”‚  â”‚    These often cannot use indexes efficiently                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  INDEX DECISION FLOWCHART:                                                  â”‚
â”‚                                                                             â”‚
â”‚       Is query slow?                                                        â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚       â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                                           â”‚
â”‚       â”‚  Yes    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                    â”‚
â”‚            â”‚                                           â”‚                    â”‚
â”‚            â–¼                                           â”‚                    â”‚
â”‚       Does EXPLAIN show table scan?                    â”‚                    â”‚
â”‚            â”‚                                           â”‚                    â”‚
â”‚            â–¼                                           â”‚                    â”‚
â”‚       â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                    â”‚
â”‚       â”‚  Yes    â”‚â”€â”€â”€â”€â”€â”€â”‚ Consider adding index   â”‚     â”‚                    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                    â”‚
â”‚                                    â”‚                   â”‚                    â”‚
â”‚                                    â–¼                   â”‚                    â”‚
â”‚                        Is table write-heavy?           â”‚                    â”‚
â”‚                                    â”‚                   â”‚                    â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                    â”‚
â”‚                        â–¼                      â–¼        â”‚                    â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                    â”‚
â”‚                   â”‚  Yes   â”‚            â”‚   No     â”‚   â”‚                    â”‚
â”‚                   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚                    â”‚
â”‚                       â”‚                      â”‚         â”‚                    â”‚
â”‚                       â–¼                      â–¼         â”‚                    â”‚
â”‚              Consider caching          Add index       â”‚                    â”‚
â”‚              or materialized           liberally       â”‚                    â”‚
â”‚              views instead                             â”‚                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.8 Query Optimization Strategies</h2>
<h3>Query Optimization Fundamentals</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      QUERY OPTIMIZATION FUNDAMENTALS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Query optimization is about getting results with minimum resource usage    â”‚
â”‚  Focus areas: CPU, Memory, I/O, Network                                     â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  QUERY EXECUTION PIPELINE                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SQL Query                                                        â”‚   â”‚
â”‚  â”‚        â”‚                                                            â”‚   â”‚
â”‚  â”‚        â–¼                                                            â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚   â”‚
â”‚  â”‚    â”‚  Parser   â”‚  Syntax validation, tokenization                   â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                    â”‚   â”‚
â”‚  â”‚          â”‚                                                          â”‚   â”‚
â”‚  â”‚          â–¼                                                          â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚   â”‚
â”‚  â”‚    â”‚ Analyzer  â”‚  Semantic validation, name resolution              â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                    â”‚   â”‚
â”‚  â”‚          â”‚                                                          â”‚   â”‚
â”‚  â”‚          â–¼                                                          â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚   â”‚
â”‚  â”‚    â”‚ Optimizer â”‚  Generate execution plans, choose best â† KEY STEP â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                    â”‚   â”‚
â”‚  â”‚          â”‚                                                          â”‚   â”‚
â”‚  â”‚          â–¼                                                          â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚   â”‚
â”‚  â”‚    â”‚ Executor  â”‚  Execute chosen plan                               â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                    â”‚   â”‚
â”‚  â”‚          â”‚                                                          â”‚   â”‚
â”‚  â”‚          â–¼                                                          â”‚   â”‚
â”‚  â”‚      Results                                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  THE OPTIMIZER'S JOB:                                                       â”‚
â”‚  â€¢ Evaluate multiple execution strategies                                   â”‚
â”‚  â€¢ Estimate cost of each strategy                                           â”‚
â”‚  â€¢ Choose lowest-cost plan                                                  â”‚
â”‚  â€¢ Uses statistics about data distribution                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Query Optimization Techniques</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    QUERY OPTIMIZATION TECHNIQUES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. SELECT ONLY NEEDED COLUMNS                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Bad:  SELECT * FROM users WHERE id = 1;                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Good: SELECT id, name, email FROM users WHERE id = 1;            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Why it matters:                                                    â”‚   â”‚
â”‚  â”‚  â€¢ Less data transferred from disk                                  â”‚   â”‚
â”‚  â”‚  â€¢ Enables covering indexes                                         â”‚   â”‚
â”‚  â”‚  â€¢ Reduces memory usage                                             â”‚   â”‚
â”‚  â”‚  â€¢ Prevents breaking code when schema changes                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. USE APPROPRIATE JOIN TYPES                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  JOIN ALGORITHMS (chosen by optimizer):                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  NESTED LOOP JOIN                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ For each row in outer table:                            â”‚       â”‚   â”‚
â”‚  â”‚  â”‚   For each row in inner table:                          â”‚       â”‚   â”‚
â”‚  â”‚  â”‚     If join condition matches: output row               â”‚       â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Best for: Small outer table, indexed inner table        â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Complexity: O(N Ã— M), or O(N Ã— log M) with index        â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  HASH JOIN                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ Build hash table from smaller table                     â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Probe with each row from larger table                   â”‚       â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Best for: Large tables, no useful indexes, equality joinâ”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Complexity: O(N + M)                                    â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Requires: Memory for hash table                         â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  MERGE JOIN                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ Sort both tables on join key                            â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Merge sorted results                                    â”‚       â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Best for: Pre-sorted data, range joins                  â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Complexity: O(N log N + M log M) for sort + O(N + M)    â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. OPTIMIZE JOIN ORDER                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Join smaller result sets first to minimize intermediate results    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example with 3 tables:                                             â”‚   â”‚
â”‚  â”‚  â€¢ orders: 10 million rows                                          â”‚   â”‚
â”‚  â”‚  â€¢ customers: 100,000 rows                                          â”‚   â”‚
â”‚  â”‚  â€¢ countries: 200 rows                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query: Get orders with customer and country info                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Suboptimal:                                                      â”‚   â”‚
â”‚  â”‚    orders â‹ˆ customers â‹ˆ countries                                   â”‚   â”‚
â”‚  â”‚    (10M Ã— 100K intermediate result)                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Better (if filtering on customer):                               â”‚   â”‚
â”‚  â”‚    customers (filtered) â‹ˆ orders â‹ˆ countries                        â”‚   â”‚
â”‚  â”‚    (smaller intermediate results)                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Note: Modern optimizers usually handle this automatically          â”‚   â”‚
â”‚  â”‚        but hints may help for complex queries                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. USE PAGINATION PROPERLY                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Bad: OFFSET-based pagination (slow for large offsets)            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders ORDER BY created_at                         â”‚   â”‚
â”‚  â”‚    LIMIT 20 OFFSET 10000;                                           â”‚   â”‚
â”‚  â”‚    -- Must scan 10,020 rows to return 20                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Good: Keyset/Cursor pagination                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders                                             â”‚   â”‚
â”‚  â”‚    WHERE created_at &gt; '2024-01-15 10:30:00'                         â”‚   â”‚
â”‚  â”‚    ORDER BY created_at                                              â”‚   â”‚
â”‚  â”‚    LIMIT 20;                                                        â”‚   â”‚
â”‚  â”‚    -- Uses index, constant performance regardless of page           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  For keyset pagination:                                             â”‚   â”‚
â”‚  â”‚  â€¢ Return last row's key with results                               â”‚   â”‚
â”‚  â”‚  â€¢ Client passes key for next page                                  â”‚   â”‚
â”‚  â”‚  â€¢ Requires stable sort order                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. OPTIMIZE SUBQUERIES                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Correlated subquery (runs once per outer row):                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders o                                           â”‚   â”‚
â”‚  â”‚    WHERE amount &gt; (                                                 â”‚   â”‚
â”‚  â”‚      SELECT AVG(amount) FROM orders                                 â”‚   â”‚
â”‚  â”‚      WHERE customer_id = o.customer_id  â† References outer query    â”‚   â”‚
â”‚  â”‚    );                                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Rewrite with JOIN:                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT o.* FROM orders o                                         â”‚   â”‚
â”‚  â”‚    JOIN (                                                           â”‚   â”‚
â”‚  â”‚      SELECT customer_id, AVG(amount) as avg_amount                  â”‚   â”‚
â”‚  â”‚      FROM orders GROUP BY customer_id                               â”‚   â”‚
â”‚  â”‚    ) avgs ON o.customer_id = avgs.customer_id                       â”‚   â”‚
â”‚  â”‚    WHERE o.amount &gt; avgs.avg_amount;                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Or use CTE (Common Table Expression):                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    WITH customer_avgs AS (                                          â”‚   â”‚
â”‚  â”‚      SELECT customer_id, AVG(amount) as avg_amount                  â”‚   â”‚
â”‚  â”‚      FROM orders GROUP BY customer_id                               â”‚   â”‚
â”‚  â”‚    )                                                                â”‚   â”‚
â”‚  â”‚    SELECT o.* FROM orders o                                         â”‚   â”‚
â”‚  â”‚    JOIN customer_avgs ca ON o.customer_id = ca.customer_id          â”‚   â”‚
â”‚  â”‚    WHERE o.amount &gt; ca.avg_amount;                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  6. USE EXISTS INSTEAD OF IN (for large lists)                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— IN with subquery (materializes all results):                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM customers                                          â”‚   â”‚
â”‚  â”‚    WHERE id IN (SELECT customer_id FROM orders                      â”‚   â”‚
â”‚  â”‚                 WHERE amount &gt; 1000);                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ EXISTS (stops at first match):                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM customers c                                        â”‚   â”‚
â”‚  â”‚    WHERE EXISTS (SELECT 1 FROM orders o                             â”‚   â”‚
â”‚  â”‚                  WHERE o.customer_id = c.id                         â”‚   â”‚
â”‚  â”‚                  AND o.amount &gt; 1000);                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Note: Modern optimizers often rewrite these equivalently           â”‚   â”‚
â”‚  â”‚        but EXISTS is semantically clearer for existence checks      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  7. BATCH OPERATIONS                                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Individual inserts (N round trips):                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    INSERT INTO logs (message) VALUES ('msg1');                      â”‚   â”‚
â”‚  â”‚    INSERT INTO logs (message) VALUES ('msg2');                      â”‚   â”‚
â”‚  â”‚    INSERT INTO logs (message) VALUES ('msg3');                      â”‚   â”‚
â”‚  â”‚    ... (1000 times)                                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Batch insert (1 round trip):                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    INSERT INTO logs (message) VALUES                                â”‚   â”‚
â”‚  â”‚      ('msg1'), ('msg2'), ('msg3'), ... ('msg1000');                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Batch size guidelines:                                             â”‚   â”‚
â”‚  â”‚  â€¢ Too small: Network overhead dominates                            â”‚   â”‚
â”‚  â”‚  â€¢ Too large: Memory issues, long locks                             â”‚   â”‚
â”‚  â”‚  â€¢ Sweet spot: Usually 100-1000 rows per batch                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Query Anti-Patterns to Avoid</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      QUERY ANTI-PATTERNS                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ANTI-PATTERN 1: N+1 QUERY PROBLEM                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Fetching related data in a loop:                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Bad (N+1 queries):                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Query 1: SELECT * FROM orders;              -- 1 query           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    For each order:                             -- N queries         â”‚   â”‚
â”‚  â”‚      Query: SELECT * FROM customers WHERE id = ?                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Total: 1 + N queries (if 100 orders = 101 queries!)              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Good (1 query with JOIN):                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT o.*, c.name, c.email                                      â”‚   â”‚
â”‚  â”‚    FROM orders o                                                    â”‚   â”‚
â”‚  â”‚    JOIN customers c ON o.customer_id = c.id;                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Good (2 queries with IN):                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Query 1: SELECT * FROM orders;                                   â”‚   â”‚
â”‚  â”‚    Query 2: SELECT * FROM customers                                 â”‚   â”‚
â”‚  â”‚             WHERE id IN (list of customer_ids);                     â”‚   â”‚
â”‚  â”‚    -- Assemble in application                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ANTI-PATTERN 2: SELECTING UNNECESSARY DATA                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Fetching entire table for count:                                 â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders;  -- then count in application              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Use COUNT:                                                       â”‚   â”‚
â”‚  â”‚    SELECT COUNT(*) FROM orders;                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Fetching all columns for existence check:                        â”‚   â”‚
â”‚  â”‚    SELECT * FROM users WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1b6f7e686f5b7e637a766b777e35787476">[email&#160;protected]</a>';            â”‚   â”‚
â”‚  â”‚    -- Check if result is not empty                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Use EXISTS or LIMIT 1:                                           â”‚   â”‚
â”‚  â”‚    SELECT 1 FROM users WHERE email = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c0b4a5b3b480a5b8a1adb0aca5eea3afad">[email&#160;protected]</a>' LIMIT 1;    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ANTI-PATTERN 3: USING DISTINCT AS A CRUTCH                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  DISTINCT often indicates a query or schema problem:                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Masking duplicate results from bad JOIN:                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT DISTINCT c.* FROM customers c                             â”‚   â”‚
â”‚  â”‚    JOIN orders o ON c.id = o.customer_id;                           â”‚   â”‚
â”‚  â”‚    -- Gets duplicate customers because of 1:N relationship          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Fix the query logic:                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM customers c                                        â”‚   â”‚
â”‚  â”‚    WHERE EXISTS (SELECT 1 FROM orders o                             â”‚   â”‚
â”‚  â”‚                  WHERE o.customer_id = c.id);                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  DISTINCT is expensive - it requires sorting or hashing             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ANTI-PATTERN 4: IMPLICIT CARTESIAN PRODUCTS                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Missing JOIN condition:                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders, customers;                                 â”‚   â”‚
â”‚  â”‚    -- Returns orders Ã— customers rows (10M Ã— 100K = 1 trillion!)    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Always specify JOIN conditions:                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    SELECT * FROM orders o                                           â”‚   â”‚
â”‚  â”‚    JOIN customers c ON o.customer_id = c.id;                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Prevention: Use explicit JOIN syntax, never comma-separated tables â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ANTI-PATTERN 5: OVERLY COMPLEX QUERIES                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Signs of over-complexity:                                          â”‚   â”‚
â”‚  â”‚  â€¢ Multiple levels of nested subqueries                             â”‚   â”‚
â”‚  â”‚  â€¢ Many JOINs (&gt; 5-6 tables)                                        â”‚   â”‚
â”‚  â”‚  â€¢ Complex CASE statements in SELECT                                â”‚   â”‚
â”‚  â”‚  â€¢ Query is hard to read/understand                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Solutions:                                                         â”‚   â”‚
â”‚  â”‚  â€¢ Break into multiple simpler queries                              â”‚   â”‚
â”‚  â”‚  â€¢ Use CTEs for readability                                         â”‚   â”‚
â”‚  â”‚  â€¢ Create views for reusable subqueries                             â”‚   â”‚
â”‚  â”‚  â€¢ Consider denormalization                                         â”‚   â”‚
â”‚  â”‚  â€¢ Move logic to application layer                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.9 Connection Management</h2>
<h3>Connection Pooling</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                        CONNECTION POOLING                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Problem: Database connections are expensive to create                      â”‚
â”‚  â€¢ TCP handshake                                                            â”‚
â”‚  â€¢ Authentication                                                           â”‚
â”‚  â€¢ Memory allocation on server                                              â”‚
â”‚  â€¢ Typically 5-50ms per connection                                          â”‚
â”‚                                                                             â”‚
â”‚  Solution: Connection pooling - reuse connections across requests           â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WITHOUT CONNECTION POOL                                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Request 1 â”€â”€â†’ [Create Conn] â”€â”€â†’ [Query] â”€â”€â†’ [Close Conn]           â”‚   â”‚
â”‚  â”‚  Request 2 â”€â”€â†’ [Create Conn] â”€â”€â†’ [Query] â”€â”€â†’ [Close Conn]           â”‚   â”‚
â”‚  â”‚  Request 3 â”€â”€â†’ [Create Conn] â”€â”€â†’ [Query] â”€â”€â†’ [Close Conn]           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Each request pays connection overhead                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WITH CONNECTION POOL                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚  â”‚                    â”‚    CONNECTION POOL      â”‚                       â”‚   â”‚
â”‚  â”‚                    â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”   â”‚                       â”‚   â”‚
â”‚  â”‚  Request 1 â”€â”€â”€â”€â”€â”€â†’ â”‚  â”‚Connâ”‚ â”‚Connâ”‚ â”‚Connâ”‚   â”‚ â”€â”€â†’ Database         â”‚   â”‚
â”‚  â”‚  Request 2 â”€â”€â”€â”€â”€â”€â†’ â”‚  â”‚ 1  â”‚ â”‚ 2  â”‚ â”‚ 3  â”‚   â”‚                       â”‚   â”‚
â”‚  â”‚  Request 3 â”€â”€â”€â”€â”€â”€â†’ â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜   â”‚                       â”‚   â”‚
â”‚  â”‚                    â”‚    (Pre-established)    â”‚                       â”‚   â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Connections created once, reused many times                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  CONNECTION POOL PARAMETERS:                                                â”‚
â”‚                                                                             â”‚
â”‚  PARAMETER          â”‚ DESCRIPTION                 â”‚ TYPICAL VALUE           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  Minimum pool size  â”‚ Connections always open     â”‚ 5-10                    â”‚
â”‚  Maximum pool size  â”‚ Hard limit on connections   â”‚ 20-100                  â”‚
â”‚  Connection timeout â”‚ Wait time for connection    â”‚ 5-30 seconds            â”‚
â”‚  Idle timeout       â”‚ Close idle connections      â”‚ 5-30 minutes            â”‚
â”‚  Max lifetime       â”‚ Recycle old connections     â”‚ 30-60 minutes           â”‚
â”‚  Validation query   â”‚ Test connection health      â”‚ "SELECT 1"              â”‚
â”‚                                                                             â”‚
â”‚  SIZING THE POOL:                                                           â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Formula (PostgreSQL recommendation):                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  connections = (core_count * 2) + effective_spindle_count           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  For SSD: connections â‰ˆ (core_count * 2) + 1                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example: 8-core server with SSD                                    â”‚   â”‚
â”‚  â”‚  connections = (8 * 2) + 1 = 17                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Note: More connections â‰  better performance                        â”‚   â”‚
â”‚  â”‚        Too many connections cause contention                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  POOL PER SERVICE vs SHARED POOL:                                           â”‚
â”‚                                                                             â”‚
â”‚  POOL PER SERVICE (Common):                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ Service Aâ”‚â”€â”€â”€â”€â†’â”‚ Pool A   â”‚â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ (10 conn)â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                                   â”œâ”€â”€â”€â”€â†’â”‚ Database â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚  â”‚ Service Bâ”‚â”€â”€â”€â”€â†’â”‚ Pool B   â”‚â”€â”€â”€â”€â”˜                                         â”‚
â”‚  â”‚ (10 conn)â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚  Total: 20 connections                                                      â”‚
â”‚                                                                             â”‚
â”‚  EXTERNAL CONNECTION POOLER (e.g., PgBouncer):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚ Service Aâ”‚â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚           â”‚     â”‚          â”‚                       â”‚
â”‚                  â”œâ”€â”€â”€â”€â†’â”‚ PgBouncer â”‚â”€â”€â”€â”€â†’â”‚ Database â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚ (Pooler)  â”‚     â”‚          â”‚                       â”‚
â”‚  â”‚ Service Bâ”‚â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚  Multiplexes many client connections to fewer DB connections                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Connection Pool Best Practices</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                  CONNECTION POOL BEST PRACTICES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. ALWAYS RETURN CONNECTIONS TO POOL                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— Bad: Connection leak                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    connection = pool.getConnection()                                â”‚   â”‚
â”‚  â”‚    result = connection.query("SELECT * FROM users")                 â”‚   â”‚
â”‚  â”‚    if (error) {                                                     â”‚   â”‚
â”‚  â”‚      throw error  // Connection never returned!                     â”‚   â”‚
â”‚  â”‚    }                                                                â”‚   â”‚
â”‚  â”‚    connection.release()                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ Good: Use try-finally or context managers                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    connection = pool.getConnection()                                â”‚   â”‚
â”‚  â”‚    try {                                                            â”‚   â”‚
â”‚  â”‚      result = connection.query("SELECT * FROM users")               â”‚   â”‚
â”‚  â”‚    } finally {                                                      â”‚   â”‚
â”‚  â”‚      connection.release()  // Always returns to pool                â”‚   â”‚
â”‚  â”‚    }                                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. SET APPROPRIATE TIMEOUTS                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Connection acquisition timeout:                                    â”‚   â”‚
â”‚  â”‚  â€¢ How long to wait for available connection                        â”‚   â”‚
â”‚  â”‚  â€¢ Fail fast rather than queue indefinitely                         â”‚   â”‚
â”‚  â”‚  â€¢ Typical: 5-30 seconds                                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Query timeout:                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Maximum time for query execution                                 â”‚   â”‚
â”‚  â”‚  â€¢ Prevents runaway queries from holding connections                â”‚   â”‚
â”‚  â”‚  â€¢ Set based on expected query duration                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Idle connection timeout:                                           â”‚   â”‚
â”‚  â”‚  â€¢ Close connections idle too long                                  â”‚   â”‚
â”‚  â”‚  â€¢ Frees server resources                                           â”‚   â”‚
â”‚  â”‚  â€¢ Typical: 10-30 minutes                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. MONITOR POOL METRICS                                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Key metrics to track:                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Active connections: Currently in use                             â”‚   â”‚
â”‚  â”‚  â€¢ Idle connections: Available in pool                              â”‚   â”‚
â”‚  â”‚  â€¢ Waiting requests: Queue for connections                          â”‚   â”‚
â”‚  â”‚  â€¢ Connection creation rate: New connections/second                 â”‚   â”‚
â”‚  â”‚  â€¢ Timeout rate: Failed to acquire connection                       â”‚   â”‚
â”‚  â”‚  â€¢ Average checkout time: Time to get connection                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Alert thresholds:                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Pool utilization &gt; 80% - consider increasing size                â”‚   â”‚
â”‚  â”‚  â€¢ Waiting requests &gt; 0 sustained - pool exhaustion                 â”‚   â”‚
â”‚  â”‚  â€¢ Timeout rate &gt; 0 - immediate attention needed                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. HANDLE STALE CONNECTIONS                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Connections can become stale due to:                               â”‚   â”‚
â”‚  â”‚  â€¢ Network issues                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Database restarts                                                â”‚   â”‚
â”‚  â”‚  â€¢ Firewall timeouts                                                â”‚   â”‚
â”‚  â”‚  â€¢ Load balancer idle timeouts                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Solutions:                                                         â”‚   â”‚
â”‚  â”‚  â€¢ Test on borrow: Validate before giving to application            â”‚   â”‚
â”‚  â”‚  â€¢ Test on return: Validate before returning to pool                â”‚   â”‚
â”‚  â”‚  â€¢ Background validation: Periodic health checks                    â”‚   â”‚
â”‚  â”‚  â€¢ Max connection lifetime: Force reconnect periodically            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.10 CQRS and Event Sourcing</h2>
<h3>Command Query Responsibility Segregation (CQRS)</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                              CQRS PATTERN                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CQRS: Separate models for reading and writing data                         â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TRADITIONAL (Single Model)                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     Commands â”€â”€â”€â”                                                   â”‚   â”‚
â”‚  â”‚     (Create,    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚      Update,    â”œâ”€â”€â”€â”€â†’â”‚  Single Model  â”‚â”€â”€â”€â”€â†’â”‚ Database â”‚          â”‚   â”‚
â”‚  â”‚      Delete)    â”‚     â”‚  (Domain Obj)  â”‚     â”‚          â”‚          â”‚   â”‚
â”‚  â”‚                 â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚     Queries â”€â”€â”€â”€â”˜                                                   â”‚   â”‚
â”‚  â”‚     (Read)                                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Problem: Optimizing for both reads and writes is difficult         â”‚   â”‚
â”‚  â”‚           Complex queries require denormalization                   â”‚   â”‚
â”‚  â”‚           Scaling reads and writes together                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CQRS (Separate Models)                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚     Commands â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚     (Create,     â”‚   WRITE     â”‚â”€â”€â”€â†’â”‚   Write Store    â”‚            â”‚   â”‚
â”‚  â”‚      Update,     â”‚   MODEL     â”‚    â”‚   (Normalized)   â”‚            â”‚   â”‚
â”‚  â”‚      Delete)     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                         â”‚                                           â”‚   â”‚
â”‚  â”‚                         â”‚ Sync/Events                               â”‚   â”‚
â”‚  â”‚                         â–¼                                           â”‚   â”‚
â”‚  â”‚     Queries â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚     (Read)       â”‚   READ      â”‚â”€â”€â”€â†’â”‚   Read Store     â”‚            â”‚   â”‚
â”‚  â”‚                  â”‚   MODEL     â”‚    â”‚  (Denormalized)  â”‚            â”‚   â”‚
â”‚  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Optimize each model independently                                â”‚   â”‚
â”‚  â”‚  â€¢ Scale reads and writes separately                                â”‚   â”‚
â”‚  â”‚  â€¢ Simpler models (single responsibility)                           â”‚   â”‚
â”‚  â”‚  â€¢ Different storage technologies for each                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  CQRS IMPLEMENTATION LEVELS:                                                â”‚
â”‚                                                                             â”‚
â”‚  LEVEL 1: Same database, different models                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Write Model â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â†â”€â”€â”€ Read Model                  â”‚   â”‚
â”‚  â”‚                   â”‚   Database   â”‚      (Different queries/views)   â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  LEVEL 2: Same database, different tables                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Write Model â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚                   â”‚ Write Tables â”‚                                  â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚                          â”‚ Triggers/Procedures                      â”‚   â”‚
â”‚  â”‚                          â–¼                                          â”‚   â”‚
â”‚  â”‚  Read Model â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚                   â”‚ Read Tables  â”‚ (Materialized views)             â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  LEVEL 3: Different databases                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Write Model â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚                   â”‚  PostgreSQL  â”‚                                  â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚                          â”‚ Event Bus / CDC                          â”‚   â”‚
â”‚  â”‚                          â–¼                                          â”‚   â”‚
â”‚  â”‚  Read Model â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚                   â”‚Elasticsearch â”‚                                  â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO USE CQRS:                                                          â”‚
â”‚                                                                             â”‚
â”‚  âœ“ Use when:                         âœ— Avoid when:                          â”‚
â”‚  â€¢ Read/write patterns very differentâ€¢ Simple CRUD applications             â”‚
â”‚  â€¢ Complex domain logic              â€¢ Small teams/projects                 â”‚
â”‚  â€¢ High read-to-write ratio          â€¢ Tight consistency required           â”‚
â”‚  â€¢ Need different scaling            â€¢ Simple queries                       â”‚
â”‚  â€¢ Complex reporting requirements    â€¢ Adding complexity not justified      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Event Sourcing</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                          EVENT SOURCING                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Event Sourcing: Store all changes as a sequence of events                  â”‚
â”‚  Current state derived by replaying events                                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TRADITIONAL (State-based)                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Account Table:                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚  â”‚  â”‚ account_id â”‚ balance â”‚ last_updated â”‚                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚   â”‚
â”‚  â”‚  â”‚ ACC001     â”‚ 750.00  â”‚ 2024-01-15   â”‚                           â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  We only know current state, not how we got here                    â”‚   â”‚
â”‚  â”‚  History is lost                                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  EVENT SOURCING                                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Event Store:                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ seq_id â”‚ account_id â”‚ event_type        â”‚ data             â”‚    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚   â”‚
â”‚  â”‚  â”‚ 1      â”‚ ACC001     â”‚ AccountOpened     â”‚ {initial: 0}     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ 2      â”‚ ACC001     â”‚ MoneyDeposited    â”‚ {amount: 1000}   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ 3      â”‚ ACC001     â”‚ MoneyWithdrawn    â”‚ {amount: 200}    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ 4      â”‚ ACC001     â”‚ MoneyWithdrawn    â”‚ {amount: 50}     â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Current balance = 0 + 1000 - 200 - 50 = 750                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Complete history preserved!                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  EVENT SOURCING ARCHITECTURE:                                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   Command â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚               â”‚   Command    â”‚â”€â”€â”€â†’â”‚   Event     â”‚                   â”‚   â”‚
â”‚  â”‚               â”‚   Handler    â”‚    â”‚   Store     â”‚                   â”‚   â”‚
â”‚  â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â”‚                                          â”‚                          â”‚   â”‚
â”‚  â”‚                                          â”‚ Events                   â”‚   â”‚
â”‚  â”‚                                          â–¼                          â”‚   â”‚
â”‚  â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚   Query â”€â”€â”€â”€â†’ â”‚   Read       â”‚â†â”€â”€â”€â”‚  Projector  â”‚                   â”‚   â”‚
â”‚  â”‚               â”‚   Model      â”‚    â”‚ (Builds     â”‚                   â”‚   â”‚
â”‚  â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  read model)â”‚                   â”‚   â”‚
â”‚  â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  KEY CONCEPTS:                                                              â”‚
â”‚                                                                             â”‚
â”‚  EVENT:                                                                     â”‚
â”‚  â€¢ Immutable record of something that happened                              â”‚
â”‚  â€¢ Past tense naming: OrderPlaced, PaymentReceived, ItemShipped             â”‚
â”‚  â€¢ Contains all data needed to reconstruct state change                     â”‚
â”‚  â€¢ Never deleted or modified                                                â”‚
â”‚                                                                             â”‚
â”‚  AGGREGATE:                                                                 â”‚
â”‚  â€¢ Consistency boundary for events                                          â”‚
â”‚  â€¢ Events belong to an aggregate instance                                   â”‚
â”‚  â€¢ State rebuilt by replaying aggregate's events                            â”‚
â”‚                                                                             â”‚
â”‚  PROJECTION:                                                                â”‚
â”‚  â€¢ Read model built from events                                             â”‚
â”‚  â€¢ Can be rebuilt at any time                                               â”‚
â”‚  â€¢ Multiple projections from same events                                    â”‚
â”‚  â€¢ Eventually consistent with event store                                   â”‚
â”‚                                                                             â”‚
â”‚  SNAPSHOT:                                                                  â”‚
â”‚  â€¢ Periodic state capture for performance                                   â”‚
â”‚  â€¢ Avoids replaying all events from beginning                               â”‚
â”‚  â€¢ Load snapshot + replay events since snapshot                             â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  BENEFITS:                                                                  â”‚
â”‚  âœ“ Complete audit trail                                                     â”‚
â”‚  âœ“ Temporal queries ("what was state on date X?")                           â”‚
â”‚  âœ“ Debug by replaying events                                                â”‚
â”‚  âœ“ Rebuild projections if logic changes                                     â”‚
â”‚  âœ“ Event-driven integration                                                 â”‚
â”‚  âœ“ Natural fit for event-driven architectures                               â”‚
â”‚                                                                             â”‚
â”‚  CHALLENGES:                                                                â”‚
â”‚  âœ— Learning curve                                                           â”‚
â”‚  âœ— Event schema evolution                                                   â”‚
â”‚  âœ— Eventual consistency complexity                                          â”‚
â”‚  âœ— Querying requires projections                                            â”‚
â”‚  âœ— Storage grows indefinitely                                               â”‚
â”‚  âœ— Handling event ordering                                                  â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO USE EVENT SOURCING:                                                â”‚
â”‚                                                                             â”‚
â”‚  âœ“ Use when:                         âœ— Avoid when:                          â”‚
â”‚  â€¢ Audit trail required              â€¢ Simple CRUD applications             â”‚
â”‚  â€¢ Complex domain events             â€¢ No audit requirements                â”‚
â”‚  â€¢ Temporal queries needed           â€¢ Team unfamiliar with pattern         â”‚
â”‚  â€¢ Event-driven architecture         â€¢ Simple data model                    â”‚
â”‚  â€¢ Need to replay/rebuild state      â€¢ Strong consistency critical          â”‚
â”‚                                                                             â”‚
â”‚  COMMON USE CASES:                                                          â”‚
â”‚  â€¢ Financial systems (transactions)                                         â”‚
â”‚  â€¢ E-commerce (order lifecycle)                                             â”‚
â”‚  â€¢ Healthcare (patient records)                                             â”‚
â”‚  â€¢ Version control systems                                                  â”‚
â”‚  â€¢ Gaming (game state, replays)                                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.11 Data Migration Strategies</h2>
<h3>Migration Approaches</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      DATA MIGRATION STRATEGIES                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. BIG BANG MIGRATION                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          Downtime           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚   Old   â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚   New   â”‚               â”‚   â”‚
â”‚  â”‚  â”‚ System  â”‚          Migration          â”‚ System  â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â”‚       â”‚                                       â”‚                     â”‚   â”‚
â”‚  â”‚       â””â”€â”€ Stop â”€â”€ Migrate All â”€â”€ Start â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Characteristics:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Single cutover event                                             â”‚   â”‚
â”‚  â”‚  â€¢ Requires maintenance window                                      â”‚   â”‚
â”‚  â”‚  â€¢ Simpler to implement                                             â”‚   â”‚
â”‚  â”‚  â€¢ Higher risk (all or nothing)                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  When to use:                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Small datasets                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Acceptable downtime window                                       â”‚   â”‚
â”‚  â”‚  â€¢ Simple schema changes                                            â”‚   â”‚
â”‚  â”‚  â€¢ Strong rollback plan                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. PHASED/INCREMENTAL MIGRATION                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ Phase 1 â”‚â”€â”€â”€â”€â†’â”‚ Phase 2 â”‚â”€â”€â”€â”€â†’â”‚ Phase 3 â”‚â”€â”€â”€â”€â†’â”‚ Phase N â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Table A â”‚     â”‚ Table B â”‚     â”‚ Table C â”‚     â”‚Complete â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Characteristics:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Migrate in chunks/phases                                         â”‚   â”‚
â”‚  â”‚  â€¢ Smaller risk per phase                                           â”‚   â”‚
â”‚  â”‚  â€¢ Can validate between phases                                      â”‚   â”‚
â”‚  â”‚  â€¢ Longer total duration                                            â”‚   â”‚
â”‚  â”‚  â€¢ More complex coordination                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  When to use:                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Large datasets                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Complex transformations                                          â”‚   â”‚
â”‚  â”‚  â€¢ Limited downtime tolerance                                       â”‚   â”‚
â”‚  â”‚  â€¢ Need to validate progressively                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. PARALLEL RUN (Dual Write)                                       â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚  â”‚                    â”‚    Application      â”‚                          â”‚   â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â”‚                               â”‚                                     â”‚   â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚  â”‚                    â”‚    Dual Write       â”‚                          â”‚   â”‚
â”‚  â”‚                    â”‚    Layer            â”‚                          â”‚   â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â”‚                         â”‚           â”‚                               â”‚   â”‚
â”‚  â”‚                         â–¼           â–¼                               â”‚   â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   â”‚
â”‚  â”‚                    â”‚  Old   â”‚  â”‚  New   â”‚                           â”‚   â”‚
â”‚  â”‚                    â”‚   DB   â”‚  â”‚   DB   â”‚                           â”‚   â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Phases:                                                            â”‚   â”‚
â”‚  â”‚  1. Write to both, read from old                                    â”‚   â”‚
â”‚  â”‚  2. Backfill historical data to new                                 â”‚   â”‚
â”‚  â”‚  3. Validate data consistency                                       â”‚   â”‚
â”‚  â”‚  4. Switch reads to new                                             â”‚   â”‚
â”‚  â”‚  5. Stop writes to old                                              â”‚   â”‚
â”‚  â”‚  6. Decommission old                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Characteristics:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Zero downtime                                                    â”‚   â”‚
â”‚  â”‚  â€¢ Real-time validation                                             â”‚   â”‚
â”‚  â”‚  â€¢ Easy rollback                                                    â”‚   â”‚
â”‚  â”‚  â€¢ Complex implementation                                           â”‚   â”‚
â”‚  â”‚  â€¢ Temporary performance impact                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. STRANGLER FIG PATTERN                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Gradually replace old system by routing traffic to new system      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚       â”‚              Load Balancer/Router           â”‚              â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                            â”‚                                        â”‚   â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚  â”‚          â”‚                 â”‚                 â”‚                      â”‚   â”‚
â”‚  â”‚          â–¼                 â–¼                 â–¼                      â”‚   â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚     â”‚Feature Aâ”‚      â”‚Feature Bâ”‚      â”‚Feature Câ”‚                  â”‚   â”‚
â”‚  â”‚     â”‚  (New)  â”‚      â”‚ (New)   â”‚      â”‚  (Old)  â”‚                  â”‚   â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Progress over time:                                                â”‚   â”‚
â”‚  â”‚  Start:  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] Old                                 â”‚   â”‚
â”‚  â”‚  Month 1:[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]â–‘â–‘â–‘â–‘ Old + New                           â”‚   â”‚
â”‚  â”‚  Month 2:[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Old + New                           â”‚   â”‚
â”‚  â”‚  Month 3:[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Old + New                           â”‚   â”‚
â”‚  â”‚  End:    [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] New                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  When to use:                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Legacy system modernization                                      â”‚   â”‚
â”‚  â”‚  â€¢ Feature-by-feature migration                                     â”‚   â”‚
â”‚  â”‚  â€¢ Need continuous operation                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. CHANGE DATA CAPTURE (CDC)                                       â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Capture and stream database changes in real-time                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ Source  â”‚â”€â”€â”€â”€â†’â”‚   CDC   â”‚â”€â”€â”€â”€â†’â”‚  Kafka  â”‚â”€â”€â”€â”€â†’â”‚ Target  â”‚       â”‚   â”‚
â”‚  â”‚  â”‚   DB    â”‚     â”‚ (Debezium)    â”‚ Stream  â”‚     â”‚   DB    â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚       â”‚                                                             â”‚   â”‚
â”‚  â”‚       â”‚ Transaction Log                                             â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Reads changes from DB log                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  CDC Methods:                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Log-based: Read database transaction log (most efficient)        â”‚   â”‚
â”‚  â”‚  â€¢ Trigger-based: Database triggers capture changes                 â”‚   â”‚
â”‚  â”‚  â€¢ Query-based: Poll for changes (timestamp/version column)         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Benefits:                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Real-time synchronization                                        â”‚   â”‚
â”‚  â”‚  â€¢ No application changes needed                                    â”‚   â”‚
â”‚  â”‚  â€¢ Low overhead on source database                                  â”‚   â”‚
â”‚  â”‚  â€¢ Reliable capture of all changes                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Popular Tools:                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Debezium (open source)                                           â”‚   â”‚
â”‚  â”‚  â€¢ AWS DMS (Database Migration Service)                             â”‚   â”‚
â”‚  â”‚  â€¢ Oracle GoldenGate                                                â”‚   â”‚
â”‚  â”‚  â€¢ Striim                                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Schema Migration Best Practices</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    SCHEMA MIGRATION BEST PRACTICES                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. BACKWARD COMPATIBLE CHANGES                                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Make changes that work with both old and new application code      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  SAFE CHANGES:                      UNSAFE CHANGES:                 â”‚   â”‚
â”‚  â”‚  âœ“ Add new column (nullable)        âœ— Remove column                 â”‚   â”‚
â”‚  â”‚  âœ“ Add new table                    âœ— Rename column                 â”‚   â”‚
â”‚  â”‚  âœ“ Add index                        âœ— Change column type            â”‚   â”‚
â”‚  â”‚  âœ“ Add default value                âœ— Add NOT NULL without default  â”‚   â”‚
â”‚  â”‚  âœ“ Widen column (VARCHAR 50â†’100)    âœ— Narrow column                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  For unsafe changes, use expand-contract pattern:                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  EXPAND:                                                            â”‚   â”‚
â”‚  â”‚  1. Add new column                                                  â”‚   â”‚
â”‚  â”‚  2. Write to both old and new columns                               â”‚   â”‚
â”‚  â”‚  3. Backfill new column with old data                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  CONTRACT:                                                          â”‚   â”‚
â”‚  â”‚  4. Update application to use new column only                       â”‚   â”‚
â”‚  â”‚  5. Remove old column                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. VERSIONED MIGRATIONS                                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Track migrations with version numbers:                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  migrations/                                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ V001__create_users_table.sql                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ V002__add_email_to_users.sql                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ V003__create_orders_table.sql                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ V004__add_index_on_email.sql                                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€ V005__add_status_to_orders.sql                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Migration table tracks applied migrations:                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ version â”‚ description                  â”‚ applied_at          â”‚  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚
â”‚  â”‚  â”‚ 001     â”‚ create_users_table           â”‚ 2024-01-01 10:00:00 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 002     â”‚ add_email_to_users           â”‚ 2024-01-05 14:30:00 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 003     â”‚ create_orders_table          â”‚ 2024-01-10 09:15:00 â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Tools: Flyway, Liquibase, Alembic, Knex, Rails Migrations          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. ZERO-DOWNTIME MIGRATION PATTERN                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Example: Renaming column 'name' to 'full_name'                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 1: Add new column                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ ALTER TABLE users ADD COLUMN full_name VARCHAR;â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚  Table: [id, name, email, full_name(new)]                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 2: Deploy code that writes to both                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ INSERT INTO users (name, full_name, email)     â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ VALUES (?, ?, ?);  -- Same value for both      â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 3: Backfill existing data                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ UPDATE users SET full_name = name              â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ WHERE full_name IS NULL;                       â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 4: Deploy code that reads from new column                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ SELECT full_name FROM users;  -- Use new columnâ”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 5: Stop writing to old column                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Step 6: Drop old column                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ ALTER TABLE users DROP COLUMN name;            â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. LARGE TABLE MIGRATION TECHNIQUES                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Problem: ALTER TABLE on large tables can lock for hours            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Solutions:                                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Online Schema Change (pt-online-schema-change, gh-ost):            â”‚   â”‚
â”‚  â”‚  1. Create new table with desired schema                            â”‚   â”‚
â”‚  â”‚  2. Create triggers to sync changes                                 â”‚   â”‚
â”‚  â”‚  3. Copy data in chunks                                             â”‚   â”‚
â”‚  â”‚  4. Rename tables atomically                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚   â”‚
â”‚  â”‚  â”‚ users      â”‚ â”€â”€â”€â†’ â”‚ users_new  â”‚  (Copy in chunks)              â”‚   â”‚
â”‚  â”‚  â”‚ (original) â”‚      â”‚ (new schema)â”‚                                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚   â”‚
â”‚  â”‚        â”‚                   â–²                                        â”‚   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚   â”‚
â”‚  â”‚         Triggers sync new changes                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  PostgreSQL specific:                                               â”‚   â”‚
â”‚  â”‚  â€¢ CREATE INDEX CONCURRENTLY (non-blocking)                         â”‚   â”‚
â”‚  â”‚  â€¢ ALTER TABLE ... SET NOT NULL (needs full scan)                   â”‚   â”‚
â”‚  â”‚  â€¢ Use pg_repack for table reorganization                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  MySQL specific:                                                    â”‚   â”‚
â”‚  â”‚  â€¢ pt-online-schema-change (Percona)                                â”‚   â”‚
â”‚  â”‚  â€¢ gh-ost (GitHub)                                                  â”‚   â”‚
â”‚  â”‚  â€¢ MySQL 8.0+ instant ADD COLUMN                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. DATA VALIDATION DURING MIGRATION                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Before migration:                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Record counts per table                                          â”‚   â”‚
â”‚  â”‚  â€¢ Checksum critical columns                                        â”‚   â”‚
â”‚  â”‚  â€¢ Sample data for comparison                                       â”‚   â”‚
â”‚  â”‚  â€¢ Document referential integrity                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  During migration:                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Monitor progress                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Track error rates                                                â”‚   â”‚
â”‚  â”‚  â€¢ Validate in batches                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  After migration:                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Compare record counts                                            â”‚   â”‚
â”‚  â”‚  â€¢ Verify checksums                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Run application tests                                            â”‚   â”‚
â”‚  â”‚  â€¢ Compare sample queries                                           â”‚   â”‚
â”‚  â”‚  â€¢ Validate business rules                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Validation query example:                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ -- Compare counts                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ SELECT                                                     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚   (SELECT COUNT(*) FROM source.users) as source_count,     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚   (SELECT COUNT(*) FROM target.users) as target_count,     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚   (SELECT COUNT(*) FROM source.users) -                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚   (SELECT COUNT(*) FROM target.users) as difference;       â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.12 Database Security</h2>
<h3>Security Best Practices</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                      DATABASE SECURITY                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. AUTHENTICATION &amp; AUTHORIZATION                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  PRINCIPLE OF LEAST PRIVILEGE:                                      â”‚   â”‚
â”‚  â”‚  Grant minimum permissions required for each role                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  ROLE              PERMISSIONS                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  app_readonly      SELECT on specific tables                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  app_readwrite     SELECT, INSERT, UPDATE on app tables       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  app_admin         All on app schema, no system tables        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  backup_user       SELECT, LOCK TABLES                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  migration_user    DDL on app schema                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  dba               All privileges (use sparingly)             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Avoid:                                                             â”‚   â”‚
â”‚  â”‚  âœ— Using root/superuser for application connections                 â”‚   â”‚
â”‚  â”‚  âœ— Shared credentials across services                               â”‚   â”‚
â”‚  â”‚  âœ— Hardcoded credentials in code                                    â”‚   â”‚
â”‚  â”‚  âœ— Same credentials for all environments                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. SQL INJECTION PREVENTION                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ— VULNERABLE (String concatenation):                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    query = "SELECT * FROM users WHERE id = " + user_input           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Attack: user_input = "1; DROP TABLE users;--"                    â”‚   â”‚
â”‚  â”‚    Result: SELECT * FROM users WHERE id = 1; DROP TABLE users;--    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  âœ“ SAFE (Parameterized queries):                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    query = "SELECT * FROM users WHERE id = ?"                       â”‚   â”‚
â”‚  â”‚    execute(query, [user_input])                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚    Input is treated as data, never executed as SQL                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Additional defenses:                                               â”‚   â”‚
â”‚  â”‚  â€¢ Input validation (whitelist allowed characters)                  â”‚   â”‚
â”‚  â”‚  â€¢ ORM usage (abstracts raw SQL)                                    â”‚   â”‚
â”‚  â”‚  â€¢ Stored procedures (pre-compiled)                                 â”‚   â”‚
â”‚  â”‚  â€¢ Web Application Firewall (WAF)                                   â”‚   â”‚
â”‚  â”‚  â€¢ Database firewall                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. ENCRYPTION                                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ENCRYPTION AT REST:                                                â”‚   â”‚
â”‚  â”‚  Data encrypted on disk                                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Application                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       â–¼                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚Database â”‚â”€â”€â”€â”€â†’â”‚Encryptionâ”‚â”€â”€â”€â†’â”‚ Encrypted Storage   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Engine  â”‚     â”‚  Layer  â”‚     â”‚ (Disk/SSD)          â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Options:                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Transparent Data Encryption (TDE) - database level       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Full disk encryption - OS/infrastructure level           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Column-level encryption - application level              â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ENCRYPTION IN TRANSIT:                                             â”‚   â”‚
â”‚  â”‚  Data encrypted over network                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Application â•â•â•â•â•â•â•TLS/SSLâ•â•â•â•â•â•â•â•â•â•â•â–º Database            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Configuration:                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Require SSL connections                                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Use strong TLS versions (1.2+)                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Verify server certificates                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Rotate certificates regularly                            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  APPLICATION-LEVEL ENCRYPTION:                                      â”‚   â”‚
â”‚  â”‚  Encrypt sensitive fields before storing                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â€¢ SSN, credit cards â†’ encrypt before INSERT                        â”‚   â”‚
â”‚  â”‚  â€¢ Database stores ciphertext                                       â”‚   â”‚
â”‚  â”‚  â€¢ Application decrypts on read                                     â”‚   â”‚
â”‚  â”‚  â€¢ Key management critical                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. NETWORK SECURITY                                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚                         INTERNET                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                            â”‚                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                     â”‚  Firewall   â”‚                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                            â”‚                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚           DMZ / Public Subnet                 â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”‚    Application Servers      â”‚           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                        â”‚                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚        Private Subnet (No internet)           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”‚      Database Server        â”‚           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”‚  â€¢ No public IP             â”‚           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”‚  â€¢ Security groups restrict â”‚           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â”‚    access to app servers    â”‚           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Rules:                                                             â”‚   â”‚
â”‚  â”‚  â€¢ Database should NEVER be directly accessible from internet       â”‚   â”‚
â”‚  â”‚  â€¢ Whitelist IP addresses for access                                â”‚   â”‚
â”‚  â”‚  â€¢ Use VPN/bastion host for admin access                            â”‚   â”‚
â”‚  â”‚  â€¢ Segment database on separate network/VLAN                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. AUDITING &amp; MONITORING                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  What to audit:                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Authentication attempts (success and failure)                    â”‚   â”‚
â”‚  â”‚  â€¢ Privilege escalation                                             â”‚   â”‚
â”‚  â”‚  â€¢ Schema changes (DDL)                                             â”‚   â”‚
â”‚  â”‚  â€¢ Access to sensitive data                                         â”‚   â”‚
â”‚  â”‚  â€¢ Data modifications on critical tables                            â”‚   â”‚
â”‚  â”‚  â€¢ Administrative actions                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Audit log entry example:                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ timestamp: 2024-01-15T10:30:45Z                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ user: app_user                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ client_ip: 10.0.1.50                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ action: SELECT                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ object: customers.credit_card                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ rows_affected: 1                                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ query: SELECT credit_card FROM customers WHERE id = 123    â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Alerting triggers:                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Multiple failed login attempts                                   â”‚   â”‚
â”‚  â”‚  â€¢ Access outside business hours                                    â”‚   â”‚
â”‚  â”‚  â€¢ Bulk data exports                                                â”‚   â”‚
â”‚  â”‚  â€¢ Schema changes in production                                     â”‚   â”‚
â”‚  â”‚  â€¢ New user creation                                                â”‚   â”‚
â”‚  â”‚  â€¢ Permission changes                                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  6. BACKUP SECURITY                                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Backups are high-value targets for attackers                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Security measures:                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Encrypt backups at rest                                          â”‚   â”‚
â”‚  â”‚  â€¢ Encrypt during transfer                                          â”‚   â”‚
â”‚  â”‚  â€¢ Restrict access to backup storage                                â”‚   â”‚
â”‚  â”‚  â€¢ Store backups in different location/account                      â”‚   â”‚
â”‚  â”‚  â€¢ Test backup restoration regularly                                â”‚   â”‚
â”‚  â”‚  â€¢ Secure and rotate encryption keys                                â”‚   â”‚
â”‚  â”‚  â€¢ Audit backup access                                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.13 Database Performance Monitoring</h2>
<h3>Key Metrics to Monitor</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                   DATABASE PERFORMANCE MONITORING                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CRITICAL METRICS DASHBOARD                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  QUERY PERFORMANCE                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Query response time (p50, p95, p99)                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Queries per second (QPS)                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Slow query count (&gt; threshold)                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Query queue length                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Full table scans per second                              â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  CONNECTION METRICS                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Active connections                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Idle connections                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Connection pool utilization                              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Connections waiting                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Connection errors/timeouts                               â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  RESOURCE UTILIZATION                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ CPU usage (user, system, iowait)                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Memory usage (buffer pool, cache hit ratio)              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Disk I/O (reads/writes per second, latency)              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Disk space (used, available, growth rate)                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Network throughput                                       â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  REPLICATION METRICS (if applicable)                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Replication lag (seconds behind primary)                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Replication throughput                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Replication errors                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Replica health status                                    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  LOCK &amp; CONTENTION                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Lock wait time                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Deadlock count                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Blocked queries                                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Lock timeout rate                                        â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  CACHE HIT RATIO:                                                           â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Cache Hit Ratio = Cache Hits / (Cache Hits + Disk Reads)           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚ RATIO    â”‚ STATUS      â”‚ ACTION                      â”‚          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚   â”‚
â”‚  â”‚  â”‚ &gt; 99%    â”‚ Excellent   â”‚ Maintain current config     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚ 95-99%   â”‚ Good        â”‚ Monitor trends              â”‚          â”‚   â”‚
â”‚  â”‚  â”‚ 90-95%   â”‚ Acceptable  â”‚ Consider increasing cache   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚ &lt; 90%    â”‚ Poor        â”‚ Increase buffer pool/cache  â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ALERT THRESHOLDS (Example):                                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  METRIC                      â”‚ WARNING    â”‚ CRITICAL                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  CPU Usage                   â”‚ &gt; 70%      â”‚ &gt; 90%                   â”‚   â”‚
â”‚  â”‚  Memory Usage                â”‚ &gt; 80%      â”‚ &gt; 95%                   â”‚   â”‚
â”‚  â”‚  Disk Usage                  â”‚ &gt; 75%      â”‚ &gt; 90%                   â”‚   â”‚
â”‚  â”‚  Connection Pool Usage       â”‚ &gt; 70%      â”‚ &gt; 90%                   â”‚   â”‚
â”‚  â”‚  Replication Lag             â”‚ &gt; 30s      â”‚ &gt; 60s                   â”‚   â”‚
â”‚  â”‚  Query Response Time (p99)   â”‚ &gt; 500ms    â”‚ &gt; 2000ms                â”‚   â”‚
â”‚  â”‚  Slow Queries per Minute     â”‚ &gt; 10       â”‚ &gt; 50                    â”‚   â”‚
â”‚  â”‚  Deadlocks per Hour          â”‚ &gt; 1        â”‚ &gt; 10                    â”‚   â”‚
â”‚  â”‚  Cache Hit Ratio             â”‚ &lt; 95%      â”‚ &lt; 90%                   â”‚   â”‚
â”‚  â”‚  Failed Connections          â”‚ &gt; 0        â”‚ &gt; 10/min                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Slow Query Analysis</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       SLOW QUERY ANALYSIS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SLOW QUERY INVESTIGATION PROCESS                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Enable Slow     â”‚                                           â”‚   â”‚
â”‚  â”‚       â”‚ Query Logging   â”‚                                           â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                â”‚                                                    â”‚   â”‚
â”‚  â”‚                â–¼                                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Identify Top    â”‚  Sort by: Total time, Frequency,          â”‚   â”‚
â”‚  â”‚       â”‚ Slow Queries    â”‚  Average time                             â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                â”‚                                                    â”‚   â”‚
â”‚  â”‚                â–¼                                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Analyze with    â”‚  EXPLAIN, EXPLAIN ANALYZE                 â”‚   â”‚
â”‚  â”‚       â”‚ Execution Plan  â”‚                                           â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                â”‚                                                    â”‚   â”‚
â”‚  â”‚                â–¼                                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Identify Root   â”‚  Missing index? Full scan?                â”‚   â”‚
â”‚  â”‚       â”‚ Cause           â”‚  Inefficient join? Lock wait?             â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                â”‚                                                    â”‚   â”‚
â”‚  â”‚                â–¼                                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Apply Fix       â”‚  Add index, Rewrite query,                â”‚   â”‚
â”‚  â”‚       â”‚                 â”‚  Add caching, Denormalize                 â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                â”‚                                                    â”‚   â”‚
â”‚  â”‚                â–¼                                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚   â”‚
â”‚  â”‚       â”‚ Verify          â”‚  Re-run query, Check metrics              â”‚   â”‚
â”‚  â”‚       â”‚ Improvement     â”‚                                           â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  COMMON SLOW QUERY CAUSES AND SOLUTIONS:                                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CAUSE                       â”‚ SOLUTION                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  Missing index               â”‚ Add appropriate index                â”‚   â”‚
â”‚  â”‚  Full table scan             â”‚ Add index, limit result set          â”‚   â”‚
â”‚  â”‚  Inefficient JOIN            â”‚ Add indexes on join columns,         â”‚   â”‚
â”‚  â”‚                              â”‚ reorder joins                        â”‚   â”‚
â”‚  â”‚  SELECT *                    â”‚ Select only needed columns           â”‚   â”‚
â”‚  â”‚  Large IN clause             â”‚ Use JOIN or temp table               â”‚   â”‚
â”‚  â”‚  LIKE '%pattern%'            â”‚ Use full-text search                 â”‚   â”‚
â”‚  â”‚  Function on indexed column  â”‚ Use functional index or rewrite      â”‚   â”‚
â”‚  â”‚  Suboptimal statistics       â”‚ Run ANALYZE                          â”‚   â”‚
â”‚  â”‚  Lock contention             â”‚ Reduce transaction scope,            â”‚   â”‚
â”‚  â”‚                              â”‚ optimize locking                     â”‚   â”‚
â”‚  â”‚  Large result set            â”‚ Add pagination, limit rows           â”‚   â”‚
â”‚  â”‚  Inefficient sorting         â”‚ Add index on ORDER BY columns        â”‚   â”‚
â”‚  â”‚  Complex aggregations        â”‚ Pre-compute, use materialized views  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.14 Polyglot Persistence</h2>
<h3>Using Multiple Database Types</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                       POLYGLOT PERSISTENCE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Definition: Using different database technologies for different            â”‚
â”‚  data storage needs within the same application                             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  E-COMMERCE PLATFORM EXAMPLE                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚   â”‚
â”‚  â”‚                     â”‚    Application      â”‚                         â”‚   â”‚
â”‚  â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚   â”‚
â”‚  â”‚                                â”‚                                    â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚       â”‚            â”‚           â”‚           â”‚            â”‚          â”‚   â”‚
â”‚  â”‚       â–¼            â–¼           â–¼           â–¼            â–¼          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚PostgreSQLâ”‚ â”‚ MongoDB â”‚ â”‚  Redis  â”‚ â”‚Elastic- â”‚ â”‚ Neo4j   â”‚      â”‚   â”‚
â”‚  â”‚  â”‚         â”‚ â”‚         â”‚ â”‚         â”‚ â”‚ search  â”‚ â”‚         â”‚      â”‚   â”‚
â”‚  â”‚  â”‚ Orders  â”‚ â”‚ Product â”‚ â”‚Sessions â”‚ â”‚ Product â”‚ â”‚ Recom-  â”‚      â”‚   â”‚
â”‚  â”‚  â”‚ Users   â”‚ â”‚ Catalog â”‚ â”‚ Cart    â”‚ â”‚ Search  â”‚ â”‚mendationsâ”‚     â”‚   â”‚
â”‚  â”‚  â”‚Payments â”‚ â”‚ Reviews â”‚ â”‚ Cache   â”‚ â”‚         â”‚ â”‚         â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Why this architecture:                                             â”‚   â”‚
â”‚  â”‚  â€¢ PostgreSQL: ACID transactions for orders/payments                â”‚   â”‚
â”‚  â”‚  â€¢ MongoDB: Flexible schema for varied product attributes           â”‚   â”‚
â”‚  â”‚  â€¢ Redis: Low-latency session and cart data                         â”‚   â”‚
â”‚  â”‚  â€¢ Elasticsearch: Full-text product search with faceting            â”‚   â”‚
â”‚  â”‚  â€¢ Neo4j: Recommendation engine using relationship traversal        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  BENEFITS:                                                                  â”‚
â”‚  âœ“ Best tool for each job                                                   â”‚
â”‚  âœ“ Optimized performance per use case                                       â”‚
â”‚  âœ“ Independent scaling of each store                                        â”‚
â”‚  âœ“ Flexibility to adopt new technologies                                    â”‚
â”‚                                                                             â”‚
â”‚  CHALLENGES:                                                                â”‚
â”‚  âœ— Operational complexity (multiple systems to manage)                      â”‚
â”‚  âœ— Data consistency across stores                                           â”‚
â”‚  âœ— Team expertise requirements                                              â”‚
â”‚  âœ— Transaction management complexity                                        â”‚
â”‚  âœ— Data synchronization overhead                                            â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  DATA SYNCHRONIZATION PATTERNS:                                             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. EVENT-DRIVEN SYNCHRONIZATION                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚  â”‚  â”‚PostgreSQLâ”‚â”€â”€â”€â”€â†’â”‚  Event  â”‚â”€â”€â”€â”€â†’â”‚Elasticsearchâ”‚                  â”‚   â”‚
â”‚  â”‚  â”‚(Primary)â”‚      â”‚  Bus    â”‚      â”‚ (Search) â”‚                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ (Kafka) â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                       â”‚   â”‚
â”‚  â”‚                        â”‚                                            â”‚   â”‚
â”‚  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚  â”‚                                   â”‚  Redis  â”‚                       â”‚   â”‚
â”‚  â”‚                                   â”‚ (Cache) â”‚                       â”‚   â”‚
â”‚  â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Products created/updated in PostgreSQL                             â”‚   â”‚
â”‚  â”‚  Events published to Kafka                                          â”‚   â”‚
â”‚  â”‚  Consumers update Elasticsearch and Redis                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. CHANGE DATA CAPTURE (CDC)                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚  â”‚  â”‚PostgreSQLâ”‚â”€â”€â”€â”€â†’â”‚ Debeziumâ”‚â”€â”€â”€â”€â†’â”‚  Kafka  â”‚                      â”‚   â”‚
â”‚  â”‚  â”‚         â”‚ CDC  â”‚         â”‚      â”‚         â”‚                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚                                         â”‚                           â”‚   â”‚
â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚                              â–¼                     â–¼                â”‚   â”‚
â”‚  â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚                        â”‚Elastic- â”‚           â”‚ Data    â”‚           â”‚   â”‚
â”‚  â”‚                        â”‚search   â”‚           â”‚Warehouseâ”‚           â”‚   â”‚
â”‚  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  No application changes needed                                      â”‚   â”‚
â”‚  â”‚  Captures all database changes automatically                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  WHEN TO USE POLYGLOT PERSISTENCE:                                          â”‚
â”‚                                                                             â”‚
â”‚  âœ“ Use when:                         âœ— Avoid when:                          â”‚
â”‚  â€¢ Distinct data access patterns     â€¢ Simple application                   â”‚
â”‚  â€¢ Specific performance needs        â€¢ Small team                           â”‚
â”‚  â€¢ Different consistency needs       â€¢ Limited operational capacity         â”‚
â”‚  â€¢ Team has relevant expertise       â€¢ Single database is sufficient        â”‚
â”‚  â€¢ Benefits outweigh complexity      â€¢ Tight coupling between data          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.15 Database Architecture Decision Framework</h2>
<h3>Decision Checklist</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                DATABASE ARCHITECTURE DECISION FRAMEWORK                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 1: UNDERSTAND DATA CHARACTERISTICS                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ What is the data structure?                                      â”‚   â”‚
â”‚  â”‚    â—‹ Structured/tabular â†’ Relational                                â”‚   â”‚
â”‚  â”‚    â—‹ Semi-structured/nested â†’ Document                              â”‚   â”‚
â”‚  â”‚    â—‹ Key-value pairs â†’ Key-Value                                    â”‚   â”‚
â”‚  â”‚    â—‹ Highly connected â†’ Graph                                       â”‚   â”‚
â”‚  â”‚    â—‹ Time-stamped sequences â†’ Time-series                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ What is the expected data volume?                                â”‚   â”‚
â”‚  â”‚    â—‹ &lt; 10 GB â†’ Most databases work                                  â”‚   â”‚
â”‚  â”‚    â—‹ 10 GB - 1 TB â†’ Consider indexing strategy                      â”‚   â”‚
â”‚  â”‚    â—‹ 1 TB - 100 TB â†’ Consider sharding                              â”‚   â”‚
â”‚  â”‚    â—‹ &gt; 100 TB â†’ Distributed databases essential                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ What is the data growth rate?                                    â”‚   â”‚
â”‚  â”‚    â—‹ Slow growth â†’ Standard capacity planning                       â”‚   â”‚
â”‚  â”‚    â—‹ Rapid growth â†’ Auto-scaling solutions                          â”‚   â”‚
â”‚  â”‚    â—‹ Unpredictable â†’ Elastic/serverless options                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 2: ANALYZE ACCESS PATTERNS                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Read/Write ratio?                                                â”‚   â”‚
â”‚  â”‚    â—‹ Read-heavy (90%+ reads) â†’ Read replicas, caching               â”‚   â”‚
â”‚  â”‚    â—‹ Write-heavy â†’ Column stores, async writes                      â”‚   â”‚
â”‚  â”‚    â—‹ Balanced â†’ Consider CQRS pattern                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Query complexity?                                                â”‚   â”‚
â”‚  â”‚    â—‹ Simple key lookups â†’ Key-value stores                          â”‚   â”‚
â”‚  â”‚    â—‹ Complex JOINs â†’ Relational databases                           â”‚   â”‚
â”‚  â”‚    â—‹ Graph traversals â†’ Graph databases                             â”‚   â”‚
â”‚  â”‚    â—‹ Full-text search â†’ Search engines                              â”‚   â”‚
â”‚  â”‚    â—‹ Aggregations â†’ Columnar/analytical stores                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Latency requirements?                                            â”‚   â”‚
â”‚  â”‚    â—‹ &lt; 10ms â†’ In-memory databases, caching                          â”‚   â”‚
â”‚  â”‚    â—‹ 10-100ms â†’ Optimized relational, document                      â”‚   â”‚
â”‚  â”‚    â—‹ &gt; 100ms acceptable â†’ More flexibility                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 3: DEFINE CONSISTENCY REQUIREMENTS                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ What consistency level is required?                              â”‚   â”‚
â”‚  â”‚    â—‹ Strong consistency â†’ ACID databases                            â”‚   â”‚
â”‚  â”‚    â—‹ Eventual consistency OK â†’ BASE/NoSQL databases                 â”‚   â”‚
â”‚  â”‚    â—‹ Per-operation flexibility â†’ Tunable consistency                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Transaction requirements?                                        â”‚   â”‚
â”‚  â”‚    â—‹ Multi-row/table transactions â†’ Relational, NewSQL              â”‚   â”‚
â”‚  â”‚    â—‹ Single-document atomic â†’ Document databases                    â”‚   â”‚
â”‚  â”‚    â—‹ Distributed transactions â†’ Saga pattern, 2PC                   â”‚   â”‚
â”‚  â”‚    â—‹ No transactions needed â†’ Most NoSQL options                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Data integrity constraints?                                      â”‚   â”‚
â”‚  â”‚    â—‹ Foreign keys essential â†’ Relational databases                  â”‚   â”‚
â”‚  â”‚    â—‹ Schema validation â†’ Document DB with schemas                   â”‚   â”‚
â”‚  â”‚    â—‹ Application-enforced â†’ Any database                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 4: EVALUATE AVAILABILITY &amp; SCALABILITY                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Availability requirements?                                       â”‚   â”‚
â”‚  â”‚    â—‹ 99.9% (8.7 hrs downtime/year) â†’ Standard HA setup              â”‚   â”‚
â”‚  â”‚    â—‹ 99.99% (52 min downtime/year) â†’ Multi-AZ deployment            â”‚   â”‚
â”‚  â”‚    â—‹ 99.999% (5 min downtime/year) â†’ Multi-region, active-active    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Scaling strategy needed?                                         â”‚   â”‚
â”‚  â”‚    â—‹ Vertical only â†’ Traditional RDBMS                              â”‚   â”‚
â”‚  â”‚    â—‹ Read scaling â†’ Read replicas                                   â”‚   â”‚
â”‚  â”‚    â—‹ Write scaling â†’ Sharding, distributed databases                â”‚   â”‚
â”‚  â”‚    â—‹ Global distribution â†’ Multi-region databases                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Geographic distribution?                                         â”‚   â”‚
â”‚  â”‚    â—‹ Single region â†’ Standard deployment                            â”‚   â”‚
â”‚  â”‚    â—‹ Multi-region reads â†’ Read replicas per region                  â”‚   â”‚
â”‚  â”‚    â—‹ Multi-region writes â†’ Global databases (Spanner, Cosmos)       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 5: CONSIDER OPERATIONAL FACTORS                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Team expertise?                                                  â”‚   â”‚
â”‚  â”‚    â—‹ Strong SQL skills â†’ Relational databases                       â”‚   â”‚
â”‚  â”‚    â—‹ NoSQL experience â†’ Document/Key-value stores                   â”‚   â”‚
â”‚  â”‚    â—‹ Limited DBA resources â†’ Managed services                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Operational capabilities?                                        â”‚   â”‚
â”‚  â”‚    â—‹ Full ops team â†’ Self-managed options                           â”‚   â”‚
â”‚  â”‚    â—‹ Limited ops â†’ Managed/serverless databases                     â”‚   â”‚
â”‚  â”‚    â—‹ DevOps model â†’ Infrastructure as Code support                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Budget constraints?                                              â”‚   â”‚
â”‚  â”‚    â—‹ Limited budget â†’ Open source (PostgreSQL, MySQL)               â”‚   â”‚
â”‚  â”‚    â—‹ Moderate budget â†’ Managed open source                          â”‚   â”‚
â”‚  â”‚    â—‹ Enterprise budget â†’ Commercial options                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Vendor lock-in concerns?                                         â”‚   â”‚
â”‚  â”‚    â—‹ Avoid lock-in â†’ Open source, standard SQL                      â”‚   â”‚
â”‚  â”‚    â—‹ Lock-in acceptable â†’ Cloud-native services                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  STEP 6: COMPLIANCE &amp; SECURITY                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Regulatory requirements?                                         â”‚   â”‚
â”‚  â”‚    â—‹ GDPR â†’ Data residency, encryption, audit                       â”‚   â”‚
â”‚  â”‚    â—‹ HIPAA â†’ Encryption, access controls, audit logs                â”‚   â”‚
â”‚  â”‚    â—‹ PCI-DSS â†’ Encryption, network isolation                        â”‚   â”‚
â”‚  â”‚    â—‹ SOC 2 â†’ Access controls, monitoring                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Data residency requirements?                                     â”‚   â”‚
â”‚  â”‚    â—‹ Specific region only â†’ Regional deployment                     â”‚   â”‚
â”‚  â”‚    â—‹ Country-specific â†’ Geo-sharding                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â–¡ Encryption requirements?                                         â”‚   â”‚
â”‚  â”‚    â—‹ At-rest encryption â†’ TDE or disk encryption                    â”‚   â”‚
â”‚  â”‚    â—‹ In-transit encryption â†’ TLS/SSL                                â”‚   â”‚
â”‚  â”‚    â—‹ Field-level encryption â†’ Application-level encryption          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<h3>Quick Reference Decision Matrix</h3>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                    QUICK REFERENCE DECISION MATRIX                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  USE CASE                          â”‚ RECOMMENDED DATABASE TYPE              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  E-commerce orders/payments        â”‚ PostgreSQL, MySQL                      â”‚
â”‚  User authentication               â”‚ PostgreSQL, MySQL + Redis (sessions)   â”‚
â”‚  Product catalog (varied attrs)    â”‚ MongoDB, PostgreSQL (JSONB)            â”‚
â”‚  Shopping cart                     â”‚ Redis, DynamoDB                        â”‚
â”‚  Session management                â”‚ Redis, Memcached                       â”‚
â”‚  Full-text search                  â”‚ Elasticsearch, PostgreSQL FTS          â”‚
â”‚  Real-time analytics               â”‚ ClickHouse, TimescaleDB                â”‚
â”‚  Social network connections        â”‚ Neo4j, Amazon Neptune                  â”‚
â”‚  IoT sensor data                   â”‚ TimescaleDB, InfluxDB, Cassandra       â”‚
â”‚  Content management                â”‚ MongoDB, PostgreSQL                    â”‚
â”‚  Logging/metrics                   â”‚ Elasticsearch, InfluxDB                â”‚
â”‚  Caching layer                     â”‚ Redis, Memcached                       â”‚
â”‚  Message queue state               â”‚ Redis, PostgreSQL                      â”‚
â”‚  Geospatial data                   â”‚ PostgreSQL (PostGIS), MongoDB          â”‚
â”‚  Configuration/feature flags       â”‚ etcd, Consul, Redis                    â”‚
â”‚  Financial ledger                  â”‚ PostgreSQL, CockroachDB                â”‚
â”‚  Multi-tenant SaaS                 â”‚ PostgreSQL (schemas), Citus            â”‚
â”‚  Global distribution needed        â”‚ CockroachDB, Spanner, Cosmos DB        â”‚
â”‚  Serverless application            â”‚ DynamoDB, Fauna, PlanetScale           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.16 Optimization Tips Summary</h2>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                 DATABASE OPTIMIZATION TIPS SUMMARY                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  DESIGN-TIME OPTIMIZATIONS                                          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  1. Choose the right database type for your use case                â”‚   â”‚
â”‚  â”‚     â†’ Don't use relational DB for graph problems                    â”‚   â”‚
â”‚  â”‚     â†’ Don't use document DB when you need complex JOINs             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  2. Design schema for query patterns, not just data storage         â”‚   â”‚
â”‚  â”‚     â†’ Identify most common queries first                            â”‚   â”‚
â”‚  â”‚     â†’ Denormalize strategically for read-heavy workloads            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  3. Choose appropriate data types                                   â”‚   â”‚
â”‚  â”‚     â†’ Use smallest data type that fits                              â”‚   â”‚
â”‚  â”‚     â†’ Consider storage and comparison costs                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  4. Plan for data growth from day one                               â”‚   â”‚
â”‚  â”‚     â†’ Design shard key carefully                                    â”‚   â”‚
â”‚  â”‚     â†’ Consider partitioning strategy early                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  5. Separate OLTP and OLAP workloads                                â”‚   â”‚
â”‚  â”‚     â†’ Use read replicas for reporting                               â”‚   â”‚
â”‚  â”‚     â†’ Consider data warehouse for analytics                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  INDEXING OPTIMIZATIONS                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  6. Index columns used in WHERE, JOIN, and ORDER BY                 â”‚   â”‚
â”‚  â”‚     â†’ But don't over-index (hurts write performance)                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  7. Use composite indexes strategically                             â”‚   â”‚
â”‚  â”‚     â†’ Order matters: equality columns first, range last             â”‚   â”‚
â”‚  â”‚     â†’ Follow leftmost prefix rule                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  8. Consider covering indexes for critical queries                  â”‚   â”‚
â”‚  â”‚     â†’ Include all columns needed by query                           â”‚   â”‚
â”‚  â”‚     â†’ Eliminates table lookups                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  9. Use partial indexes for filtered queries                        â”‚   â”‚
â”‚  â”‚     â†’ Index only rows that match common filter                      â”‚   â”‚
â”‚  â”‚     â†’ Smaller index = faster maintenance                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  10. Monitor and remove unused indexes                              â”‚   â”‚
â”‚  â”‚      â†’ Check index usage statistics regularly                       â”‚   â”‚
â”‚  â”‚      â†’ Unused indexes waste resources                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  QUERY OPTIMIZATIONS                                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  11. Always use parameterized queries                               â”‚   â”‚
â”‚  â”‚      â†’ Prevents SQL injection                                       â”‚   â”‚
â”‚  â”‚      â†’ Enables query plan caching                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  12. Select only needed columns (avoid SELECT *)                    â”‚   â”‚
â”‚  â”‚      â†’ Reduces I/O and network transfer                             â”‚   â”‚
â”‚  â”‚      â†’ Enables covering index usage                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  13. Use EXPLAIN/ANALYZE to understand query plans                  â”‚   â”‚
â”‚  â”‚      â†’ Identify full table scans                                    â”‚   â”‚
â”‚  â”‚      â†’ Verify index usage                                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  14. Avoid N+1 query patterns                                       â”‚   â”‚
â”‚  â”‚      â†’ Use JOINs or batch queries                                   â”‚   â”‚
â”‚  â”‚      â†’ Leverage ORM eager loading                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  15. Use keyset pagination instead of OFFSET                        â”‚   â”‚
â”‚  â”‚      â†’ OFFSET scans all skipped rows                                â”‚   â”‚
â”‚  â”‚      â†’ Keyset pagination uses index                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  16. Batch bulk operations                                          â”‚   â”‚
â”‚  â”‚      â†’ Reduce round trips                                           â”‚   â”‚
â”‚  â”‚      â†’ Optimal batch size: 100-1000 rows                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CONNECTION &amp; RESOURCE OPTIMIZATIONS                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  17. Always use connection pooling                                  â”‚   â”‚
â”‚  â”‚      â†’ Reuse connections instead of creating new ones               â”‚   â”‚
â”‚  â”‚      â†’ Size pool appropriately (not too large)                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  18. Set appropriate timeouts                                       â”‚   â”‚
â”‚  â”‚      â†’ Connection timeout                                           â”‚   â”‚
â”‚  â”‚      â†’ Query timeout                                                â”‚   â”‚
â”‚  â”‚      â†’ Idle connection timeout                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  19. Close connections properly (use try-finally)                   â”‚   â”‚
â”‚  â”‚      â†’ Return to pool even on errors                                â”‚   â”‚
â”‚  â”‚      â†’ Prevent connection leaks                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  20. Monitor and tune buffer pool / cache size                      â”‚   â”‚
â”‚  â”‚      â†’ Target &gt; 99% cache hit ratio                                 â”‚   â”‚
â”‚  â”‚      â†’ Allocate 70-80% of available memory                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SCALING OPTIMIZATIONS                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  21. Use read replicas for read-heavy workloads                     â”‚   â”‚
â”‚  â”‚      â†’ Distribute read traffic                                      â”‚   â”‚
â”‚  â”‚      â†’ Keep writes on primary                                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  22. Implement caching layer for frequently accessed data           â”‚   â”‚
â”‚  â”‚      â†’ Redis/Memcached for hot data                                 â”‚   â”‚
â”‚  â”‚      â†’ Cache invalidation strategy critical                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  23. Consider CQRS for complex read/write patterns                  â”‚   â”‚
â”‚  â”‚      â†’ Separate read and write models                               â”‚   â”‚
â”‚  â”‚      â†’ Optimize each independently                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  24. Archive old data                                               â”‚   â”‚
â”‚  â”‚      â†’ Move historical data to cold storage                         â”‚   â”‚
â”‚  â”‚      â†’ Keep active tables small                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  25. Use table partitioning for large tables                        â”‚   â”‚
â”‚  â”‚      â†’ Partition by date for time-series                            â”‚   â”‚
â”‚  â”‚      â†’ Enables partition pruning                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  OPERATIONAL OPTIMIZATIONS                                          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  26. Keep statistics up to date                                     â”‚   â”‚
â”‚  â”‚      â†’ Run ANALYZE regularly                                        â”‚   â”‚
â”‚  â”‚      â†’ Enable auto-vacuum/auto-analyze                              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  27. Perform regular maintenance                                    â”‚   â”‚
â”‚  â”‚      â†’ Index rebuilding                                             â”‚   â”‚
â”‚  â”‚      â†’ Table vacuuming/optimization                                 â”‚   â”‚
â”‚  â”‚      â†’ Log rotation                                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  28. Monitor slow queries continuously                              â”‚   â”‚
â”‚  â”‚      â†’ Enable slow query logging                                    â”‚   â”‚
â”‚  â”‚      â†’ Set up alerts for query duration                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  29. Test migrations in staging first                               â”‚   â”‚
â”‚  â”‚      â†’ Use production-like data volume                              â”‚   â”‚
â”‚  â”‚      â†’ Measure migration duration                                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  30. Have a backup and recovery plan                                â”‚   â”‚
â”‚  â”‚      â†’ Test restores regularly                                      â”‚   â”‚
â”‚  â”‚      â†’ Document RTO and RPO                                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>9.17 Section Summary and Key Takeaways</h2>
<div class="relative"><pre style="color: rgb(57, 58, 52); font-family: Consolas, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; font-size: 0.9em; line-height: 1.2em; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border: 1px solid rgb(221, 221, 221); background-color: white;"><code style="white-space: pre-wrap; word-break: break-all;"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span>â”‚                  KEY TAKEAWAYS - SECTION 9                                   â”‚
â”‚                  DATABASE ARCHITECTURE STRATEGIES                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  âœ… DATABASE SELECTION                                                       â”‚
â”‚     â€¢ Choose database type based on data structure and access patterns      â”‚
â”‚     â€¢ Relational for complex transactions and relationships                 â”‚
â”‚     â€¢ Document for flexible schemas and nested data                         â”‚
â”‚     â€¢ Key-value for simple lookups and caching                              â”‚
â”‚     â€¢ Graph for relationship-heavy data                                     â”‚
â”‚     â€¢ Time-series for temporal data                                         â”‚
â”‚     â€¢ Consider polyglot persistence for complex systems                     â”‚
â”‚                                                                             â”‚
â”‚  âœ… CAP THEOREM AND CONSISTENCY                                              â”‚
â”‚     â€¢ Distributed systems can only guarantee 2 of 3: C, A, P                â”‚
â”‚     â€¢ In practice, choose between CP (consistency) and AP (availability)    â”‚
â”‚     â€¢ ACID for transactions requiring strong consistency                    â”‚
â”‚     â€¢ BASE for high availability with eventual consistency                  â”‚
â”‚     â€¢ Choose isolation level based on requirements (not maximum)            â”‚
â”‚                                                                             â”‚
â”‚  âœ… DATA MODELING                                                            â”‚
â”‚     â€¢ Normalize for write-heavy, denormalize for read-heavy                 â”‚
â”‚     â€¢ Design schema for queries, not just storage                           â”‚
â”‚     â€¢ Document DBs: embed for 1:few, reference for 1:many                   â”‚
â”‚     â€¢ Use patterns: subset, extended reference, bucket, polymorphic         â”‚
â”‚                                                                             â”‚
â”‚  âœ… SCALING STRATEGIES                                                       â”‚
â”‚     â€¢ Start with vertical scaling - it's simpler                            â”‚
â”‚     â€¢ Use read replicas for read-heavy workloads                            â”‚
â”‚     â€¢ Sharding for write scaling and large datasets                         â”‚
â”‚     â€¢ Choose shard key carefully - it's the most critical decision          â”‚
â”‚     â€¢ Avoid monotonic shard keys (timestamps, auto-increment)               â”‚
â”‚                                                                             â”‚
â”‚  âœ… INDEXING                                                                 â”‚
â”‚     â€¢ Index columns in WHERE, JOIN, ORDER BY clauses                        â”‚
â”‚     â€¢ Composite index order matters: equality first, range last             â”‚
â”‚     â€¢ Don't over-index - each index slows writes                            â”‚
â”‚     â€¢ Monitor index usage and remove unused indexes                         â”‚
â”‚     â€¢ Use EXPLAIN to verify index usage                                     â”‚
â”‚                                                                             â”‚
â”‚  âœ… QUERY OPTIMIZATION                                                       â”‚
â”‚     â€¢ Always use parameterized queries                                      â”‚
â”‚     â€¢ Avoid SELECT * - select only needed columns                           â”‚
â”‚     â€¢ Eliminate N+1 query patterns                                          â”‚
â”‚     â€¢ Use keyset pagination for large result sets                           â”‚
â”‚     â€¢ Batch bulk operations                                                 â”‚
â”‚                                                                             â”‚
â”‚  âœ… CONNECTION MANAGEMENT                                                    â”‚
â”‚     â€¢ Always use connection pooling                                         â”‚
â”‚     â€¢ Size pool appropriately (more isn't always better)                    â”‚
â”‚     â€¢ Set appropriate timeouts                                              â”‚
â”‚     â€¢ Always return connections to pool (try-finally)                       â”‚
â”‚     â€¢ Monitor pool utilization                                              â”‚
â”‚                                                                             â”‚
â”‚  âœ… CQRS AND EVENT SOURCING                                                  â”‚
â”‚     â€¢ CQRS: separate read and write models for complex systems              â”‚
â”‚     â€¢ Event sourcing: store changes as events, derive state                 â”‚
â”‚     â€¢ Use for audit trails, temporal queries, complex domains               â”‚
â”‚     â€¢ Adds complexity - use only when benefits justify                      â”‚
â”‚                                                                             â”‚
â”‚  âœ… MIGRATIONS                                                               â”‚
â”‚     â€¢ Use versioned migrations (Flyway, Liquibase)                          â”‚
â”‚     â€¢ Make backward-compatible changes when possible                        â”‚
â”‚     â€¢ Use expand-contract pattern for breaking changes                      â”‚
â”‚     â€¢ Test migrations with production-like data volumes                     â”‚
â”‚     â€¢ Consider online schema change tools for large tables                  â”‚
â”‚                                                                             â”‚
â”‚  âœ… SECURITY                                                                 â”‚
â”‚     â€¢ Principle of least privilege for database users                       â”‚
â”‚     â€¢ Always use parameterized queries (prevent SQL injection)              â”‚
â”‚     â€¢ Encrypt data at rest and in transit                                   â”‚
â”‚     â€¢ Database should never be directly accessible from internet            â”‚
â”‚     â€¢ Implement comprehensive audit logging                                 â”‚
â”‚     â€¢ Secure backups with encryption                                        â”‚
â”‚                                                                             â”‚
â”‚  âœ… MONITORING                                                               â”‚
â”‚     â€¢ Monitor query performance (p50, p95, p99)                             â”‚
â”‚     â€¢ Track connection pool utilization                                     â”‚
â”‚     â€¢ Monitor replication lag                                               â”‚
â”‚     â€¢ Alert on slow queries and resource exhaustion                         â”‚
â”‚     â€¢ Keep statistics up to date (ANALYZE)                                  â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  REMEMBER:                                                                  â”‚
â”‚  â€¢ Database is often the bottleneck - optimize proactively                  â”‚
â”‚  â€¢ Wrong database choice is expensive to fix later                          â”‚
â”‚  â€¢ Start simple, add complexity only when needed                            â”‚
â”‚  â€¢ Measure before optimizing - avoid premature optimization                 â”‚
â”‚  â€¢ Plan for growth but don't over-engineer                                  â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  NEXT SECTION: Section 10 - Caching Architecture                            â”‚
â”‚  Topics: Caching strategies, cache invalidation, distributed caching,       â”‚
â”‚          cache-aside, write-through, write-behind patterns                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div>
<hr>
<h2>Ready for Section 10?</h2>
<p><strong>Section 10: Caching Architecture</strong> will cover:</p>
<ul>
<li>Caching Fundamentals and Benefits</li>
<li>Cache Placement Strategies</li>
<li>Caching Patterns (Cache-Aside, Read-Through, Write-Through, Write-Behind)</li>
<li>Cache Invalidation Strategies</li>
<li>Distributed Caching</li>
<li>Cache Eviction Policies</li>
<li>CDN and Edge Caching</li>
<li>Caching Best Practices and Pitfalls</li>
<li>Cache Warming and Preloading</li>
<li>Monitoring and Optimization</li>
</ul>
<hr>
</div>


</div>
<!-- ========== data-index="10" ========== -->
        </main>
        
        <nav class="chapter-nav">
            <a href="chapter-8.html" class="nav-button prev">Previous: API Design &amp; Gateway Patterns</a>
            <a href="index.html" class="home-button">Table of Contents</a>
            <a href="chapter-10.html" class="nav-button next">Next: Caching Architecture</a>
        </nav>
    </div>

    <!-- Progress Bar & Navigation Script -->
    <div id="section-progress-container" style="position: fixed; top: 20px; right: 20px; width: 10px; height: 150px; background: rgba(59, 130, 246, 0.2); border: 2px solid #3b82f6; border-radius: 6px; overflow: hidden; z-index: 1000;">
        <div id="section-progress-bar" style="width: 100%; background: linear-gradient(180deg, #1e3a8a, #3b82f6); height: 0%; transition: height 0.2s;"></div>
    </div>
    <div id="section-progress-percentage" style="position: fixed; top: 0px; right: 16px; color: #1e3a8a; font-size: 14px; font-weight: bold; z-index: 1001; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">0%</div>

    <script>
    // Smooth scroll progress indicator
    const progressBar = document.getElementById('section-progress-bar');
    const percentageDisplay = document.getElementById('section-progress-percentage');

    function updateProgress() {
        const scrollTop = window.scrollY;
        const docHeight = document.body.scrollHeight - window.innerHeight;
        const scrolled = (scrollTop / docHeight) * 100;
        
        progressBar.style.height = scrolled + '%';
        percentageDisplay.textContent = Math.round(scrolled) + '%';
    }

    window.addEventListener('scroll', updateProgress);
    updateProgress();

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName)) return;
        
        if (e.key === 'ArrowLeft') {
            const prevBtn = document.querySelector('.nav-button.prev');
            if (prevBtn && !prevBtn.classList.contains('disabled')) {
                window.location.href = prevBtn.href;
            }
        }
        
        if (e.key === 'ArrowRight') {
            const nextBtn = document.querySelector('.nav-button.next');
            if (nextBtn && !nextBtn.classList.contains('disabled')) {
                window.location.href = nextBtn.href;
            }
        }
    });
    </script>

</body>
</html>